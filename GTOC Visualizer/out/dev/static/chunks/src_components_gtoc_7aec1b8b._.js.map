{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/solutions/parseSolutionFile.ts"],"sourcesContent":["import { Solution, SamplePt } from \"./types\";\r\n\r\nconst PALETTE = [\r\n  \"#ff6b6b\", \"#4dabf7\", \"#63e6be\", \"#ffd43b\", \"#845ef7\",\r\n  \"#ffa94d\", \"#5c7cfa\", \"#94d82d\", \"#fcc2d7\", \"#66d9e8\",\r\n];\r\n\r\nfunction randomColor() {\r\n  return PALETTE[Math.floor(Math.random() * PALETTE.length)];\r\n}\r\n\r\n/** Deterministic parser: reads rows exactly as-is (km or AU) */\r\nexport async function parseSolutionFile(file: File): Promise<Solution> {\r\n  const text = await file.text();\r\n  const lines = text\r\n    .split(/\\r?\\n/)\r\n    .map((l) => l.trim())\r\n    .filter((l) => l && !l.startsWith(\"#\") && !l.startsWith(\"//\") && !l.startsWith(\"!\"));\r\n\r\n  const samples: SamplePt[] = [];\r\n\r\n  for (const line of lines) {\r\n    const parts = line.split(/[,\\s]+/).map(Number);\r\n    if (parts.length < 6) continue;\r\n\r\n    const [bodyId, flag, t, x, y, z, vx, vy, vz] = parts;\r\n    samples.push({\r\n      t,\r\n      p: [x, y, z],\r\n      v: [vx ?? 0, vy ?? 0, vz ?? 0],\r\n      bodyId,\r\n      flag,\r\n    });\r\n  }\r\n\r\n  return {\r\n    id: file.name,\r\n    name: file.name,\r\n    color: randomColor(),\r\n    samples,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;AAEA,MAAM,UAAU;IACd;IAAW;IAAW;IAAW;IAAW;IAC5C;IAAW;IAAW;IAAW;IAAW;CAC7C;AAED,SAAS;IACP,OAAO,OAAO,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ,MAAM,EAAE;AAC5D;AAGO,eAAe,kBAAkB,IAAU;IAChD,MAAM,OAAO,MAAM,KAAK,IAAI;IAC5B,MAAM,QAAQ,KACX,KAAK,CAAC,SACN,GAAG,CAAC,CAAC,IAAM,EAAE,IAAI,IACjB,MAAM,CAAC,CAAC,IAAM,KAAK,CAAC,EAAE,UAAU,CAAC,QAAQ,CAAC,EAAE,UAAU,CAAC,SAAS,CAAC,EAAE,UAAU,CAAC;IAEjF,MAAM,UAAsB,EAAE;IAE9B,KAAK,MAAM,QAAQ,MAAO;QACxB,MAAM,QAAQ,KAAK,KAAK,CAAC,UAAU,GAAG,CAAC;QACvC,IAAI,MAAM,MAAM,GAAG,GAAG;QAEtB,MAAM,CAAC,QAAQ,MAAM,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,GAAG;QAC/C,QAAQ,IAAI,CAAC;YACX;YACA,GAAG;gBAAC;gBAAG;gBAAG;aAAE;YACZ,GAAG;gBAAC,MAAM;gBAAG,MAAM;gBAAG,MAAM;aAAE;YAC9B;YACA;QACF;IACF;IAEA,OAAO;QACL,IAAI,KAAK,IAAI;QACb,MAAM,KAAK,IAAI;QACf,OAAO;QACP;IACF;AACF","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/solutions/useSolutions.ts"],"sourcesContent":["import { create } from \"zustand\";\r\nimport { Solution } from \"./types\";\r\nimport { parseSolutionFile } from \"./parseSolutionFile\";\r\n\r\n/* ---------- Types ---------- */\r\ntype SolutionsState = {\r\n  solutions: Solution[];\r\n  visible: Record<string, boolean>;\r\n  importSolution: (file: File) => Promise<void>;\r\n  deleteSolution: (id: string) => Promise<void>;\r\n  toggle: (id: string) => void;\r\n  recolorSolution: (id: string, newColor: string) => void;\r\n  loadPersisted: () => Promise<void>;\r\n};\r\n\r\n/* ---------- Zustand global store ---------- */\r\nexport const useSolutions = create<SolutionsState>((set, get) => ({\r\n  solutions: [],\r\n  visible: {},\r\n\r\n  /* === Load all persisted solutions from /api/solutions === */\r\n  loadPersisted: async () => {\r\n    try {\r\n      const res = await fetch(\"/api/solutions\");\r\n      if (!res.ok) throw new Error(\"Failed to load persisted solutions\");\r\n      const data = await res.json();\r\n      const sols: Solution[] = data.solutions ?? [];\r\n      const visibility = Object.fromEntries(sols.map((s) => [s.id, true]));\r\n      console.log(`[useSolutions] Loaded ${sols.length} persisted solutions`);\r\n      set({ solutions: sols, visible: visibility });\r\n    } catch (err) {\r\n      console.error(\"[useSolutions] loadPersisted error:\", err);\r\n    }\r\n  },\r\n\r\n  /* === Import new file ‚Üí persist to disk ‚Üí load it locally === */\r\n  importSolution: async (file: File) => {\r\n    try {\r\n      // Upload to API (permanent storage)\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      const uploadRes = await fetch(\"/api/solutions\", {\r\n        method: \"POST\",\r\n        body: formData,\r\n      });\r\n      if (!uploadRes.ok) throw new Error(\"Failed to upload solution\");\r\n      console.log(`[useSolutions] Uploaded ${file.name}`);\r\n\r\n      // Parse locally for immediate visualization\r\n      const sol = await parseSolutionFile(file);\r\n\r\n      set((state) => ({\r\n        solutions: [...state.solutions, sol],\r\n        visible: { ...state.visible, [sol.id]: true },\r\n      }));\r\n    } catch (err) {\r\n      console.error(\"[useSolutions] importSolution error:\", err);\r\n    }\r\n  },\r\n\r\n  /* === Delete a solution (both locally + server-side) === */\r\n  deleteSolution: async (id: string) => {\r\n    try {\r\n      await fetch(`/api/solutions?name=${encodeURIComponent(id)}`, {\r\n        method: \"DELETE\",\r\n      });\r\n      console.log(`[useSolutions] Deleted ${id}`);\r\n      set((state) => ({\r\n        solutions: state.solutions.filter((s) => s.id !== id),\r\n        visible: Object.fromEntries(\r\n          Object.entries(state.visible).filter(([k]) => k !== id)\r\n        ),\r\n      }));\r\n    } catch (err) {\r\n      console.error(\"[useSolutions] deleteSolution error:\", err);\r\n    }\r\n  },\r\n\r\n  /* === Toggle visibility of a given solution === */\r\n  toggle: (id: string) =>\r\n    set((state) => ({\r\n      visible: { ...state.visible, [id]: !state.visible[id] },\r\n    })),\r\n\r\n  /* === Recolor a given solution === */\r\n  recolorSolution: (id, newColor) =>\r\n    set((state) => {\r\n      console.log(`[useSolutions] recolorSolution ‚Üí ${id} = ${newColor}`);\r\n      const updated = state.solutions.map((s) =>\r\n        s.id === id ? { ...s, color: newColor } : s\r\n      );\r\n      return { solutions: [...updated] }; // ensure new array reference\r\n    }),\r\n}));\r\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;AAcO,MAAM,eAAe,IAAA,qJAAM,EAAiB,CAAC,KAAK,MAAQ,CAAC;QAChE,WAAW,EAAE;QACb,SAAS,CAAC;QAEV,4DAA4D,GAC5D,eAAe;YACb,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;gBAC7B,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,MAAM,OAAmB,KAAK,SAAS,IAAI,EAAE;gBAC7C,MAAM,aAAa,OAAO,WAAW,CAAC,KAAK,GAAG,CAAC,CAAC,IAAM;wBAAC,EAAE,EAAE;wBAAE;qBAAK;gBAClE,QAAQ,GAAG,CAAC,CAAC,sBAAsB,EAAE,KAAK,MAAM,CAAC,oBAAoB,CAAC;gBACtE,IAAI;oBAAE,WAAW;oBAAM,SAAS;gBAAW;YAC7C,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,uCAAuC;YACvD;QACF;QAEA,+DAA+D,GAC/D,gBAAgB,OAAO;YACrB,IAAI;gBACF,oCAAoC;gBACpC,MAAM,WAAW,IAAI;gBACrB,SAAS,MAAM,CAAC,QAAQ;gBACxB,MAAM,YAAY,MAAM,MAAM,kBAAkB;oBAC9C,QAAQ;oBACR,MAAM;gBACR;gBACA,IAAI,CAAC,UAAU,EAAE,EAAE,MAAM,IAAI,MAAM;gBACnC,QAAQ,GAAG,CAAC,CAAC,wBAAwB,EAAE,KAAK,IAAI,EAAE;gBAElD,4CAA4C;gBAC5C,MAAM,MAAM,MAAM,IAAA,mLAAiB,EAAC;gBAEpC,IAAI,CAAC,QAAU,CAAC;wBACd,WAAW;+BAAI,MAAM,SAAS;4BAAE;yBAAI;wBACpC,SAAS;4BAAE,GAAG,MAAM,OAAO;4BAAE,CAAC,IAAI,EAAE,CAAC,EAAE;wBAAK;oBAC9C,CAAC;YACH,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,wCAAwC;YACxD;QACF;QAEA,0DAA0D,GAC1D,gBAAgB,OAAO;YACrB,IAAI;gBACF,MAAM,MAAM,CAAC,oBAAoB,EAAE,mBAAmB,KAAK,EAAE;oBAC3D,QAAQ;gBACV;gBACA,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,IAAI;gBAC1C,IAAI,CAAC,QAAU,CAAC;wBACd,WAAW,MAAM,SAAS,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;wBAClD,SAAS,OAAO,WAAW,CACzB,OAAO,OAAO,CAAC,MAAM,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC,EAAE,GAAK,MAAM;oBAExD,CAAC;YACH,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,wCAAwC;YACxD;QACF;QAEA,iDAAiD,GACjD,QAAQ,CAAC,KACP,IAAI,CAAC,QAAU,CAAC;oBACd,SAAS;wBAAE,GAAG,MAAM,OAAO;wBAAE,CAAC,GAAG,EAAE,CAAC,MAAM,OAAO,CAAC,GAAG;oBAAC;gBACxD,CAAC;QAEH,oCAAoC,GACpC,iBAAiB,CAAC,IAAI,WACpB,IAAI,CAAC;gBACH,QAAQ,GAAG,CAAC,CAAC,iCAAiC,EAAE,GAAG,GAAG,EAAE,UAAU;gBAClE,MAAM,UAAU,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC,IACnC,EAAE,EAAE,KAAK,KAAK;wBAAE,GAAG,CAAC;wBAAE,OAAO;oBAAS,IAAI;gBAE5C,OAAO;oBAAE,WAAW;2BAAI;qBAAQ;gBAAC,GAAG,6BAA6B;YACnE;IACJ,CAAC","debugId":null}},
    {"offset": {"line": 158, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/solutions/SolutionsUI.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport { HexColorPicker } from \"react-colorful\";\r\nimport { useSolutions } from \"./useSolutions\";\r\nimport type { Solution } from \"./types\";\r\n\r\n/* ---------- Floating color picker portal ---------- */\r\nfunction ColorPickerPortal({\r\n  anchorRef,\r\n  color,\r\n  onChange,\r\n  onClose,\r\n}: {\r\n  anchorRef: React.RefObject<HTMLElement>;\r\n  color: string;\r\n  onChange: (c: string) => void;\r\n  onClose: () => void;\r\n}) {\r\n  const pickerRef = useRef<HTMLDivElement | null>(null);\r\n  const [pos, setPos] = useState({ x: 0, y: 0 });\r\n  const [tempColor, setTempColor] = useState(color);\r\n\r\n  // üß≠ Smart positioning (prevent offscreen)\r\n  useEffect(() => {\r\n    const el = anchorRef.current;\r\n    if (!el) return;\r\n    const rect = el.getBoundingClientRect();\r\n    const pickerWidth = 200;\r\n    const pickerHeight = 190;\r\n    let x = rect.right + 10;\r\n    let y = rect.top;\r\n    if (x + pickerWidth > window.innerWidth) x = rect.left - pickerWidth - 10;\r\n    if (y + pickerHeight > window.innerHeight)\r\n      y = window.innerHeight - pickerHeight - 10;\r\n    setPos({ x, y });\r\n  }, [anchorRef]);\r\n\r\n  // üñ± Close on outside click\r\n  useEffect(() => {\r\n    const handleClick = (e: MouseEvent) => {\r\n      const target = e.target as Node;\r\n      if (\r\n        !anchorRef.current?.contains(target) &&\r\n        !pickerRef.current?.contains(target)\r\n      ) {\r\n        onClose();\r\n      }\r\n    };\r\n    window.addEventListener(\"mousedown\", handleClick);\r\n    return () => window.removeEventListener(\"mousedown\", handleClick);\r\n  }, [anchorRef, onClose]);\r\n\r\n  return (\r\n    <div\r\n      ref={pickerRef}\r\n      className=\"fixed z-[9999] p-3 rounded-xl bg-black/90 border border-white/10 shadow-2xl backdrop-blur-sm flex flex-col items-center space-y-2\"\r\n      style={{ left: pos.x, top: pos.y }}\r\n    >\r\n      <HexColorPicker color={tempColor} onChange={setTempColor} />\r\n      <div className=\"flex gap-2 mt-2\">\r\n        {/* ‚úÖ Save button ‚Äî commits and closes after small delay */}\r\n        <button\r\n          onClick={() => {\r\n            onChange(tempColor);\r\n            setTimeout(() => onClose(), 50); // ensures store updates before unmount\r\n          }}\r\n          className=\"px-3 py-1 rounded bg-green-500/80 hover:bg-green-400 text-white text-xs font-semibold shadow\"\r\n        >\r\n          Save\r\n        </button>\r\n\r\n        {/* ‚ùå Cancel button */}\r\n        <button\r\n          onClick={onClose}\r\n          className=\"px-3 py-1 rounded bg-red-500/60 hover:bg-red-400 text-white text-xs font-semibold shadow\"\r\n        >\r\n          Cancel\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ---------- Main Solutions UI ---------- */\r\nexport default function SolutionsUI() {\r\n  const {\r\n    solutions,\r\n    visible,\r\n    importSolution,\r\n    toggle,\r\n    deleteSolution,\r\n    recolorSolution,\r\n  } = useSolutions() as any;\r\n\r\n  const [openPicker, setOpenPicker] = useState<string | null>(null);\r\n  const btnRefs = useRef<Record<string, HTMLButtonElement | null>>({});\r\n\r\n  return (\r\n    <div className=\"absolute top-3 right-3 z-[70] pointer-events-auto bg-black/70 border border-white/10 rounded-xl p-3 w-80 text-white\">\r\n      {/* Header */}\r\n      <div className=\"flex justify-between items-center mb-2\">\r\n        <h3 className=\"font-semibold text-sm\">Solutions</h3>\r\n        <label className=\"text-xs border border-white/20 rounded px-2 py-1 cursor-pointer hover:bg-white/10\">\r\n          Import\r\n          <input\r\n            type=\"file\"\r\n            accept=\".txt\"\r\n            className=\"hidden\"\r\n            onChange={(e) => {\r\n              const f = e.target.files?.[0];\r\n              if (f) importSolution(f);\r\n              e.target.value = \"\";\r\n            }}\r\n          />\r\n        </label>\r\n      </div>\r\n\r\n      {/* List */}\r\n      <div className=\"space-y-1 max-h-[60vh] overflow-y-auto pr-1\">\r\n        {solutions.map((s: Solution) => (\r\n          <div\r\n            key={s.id}\r\n            className=\"flex items-center justify-between border border-white/15 rounded px-2 py-1 text-xs hover:bg-white/5 transition-colors\"\r\n          >\r\n            <span className=\"truncate flex-1\">{s.name}</span>\r\n\r\n            {/* üé® Color button */}\r\n            <button\r\n              ref={(el) => {\r\n                btnRefs.current[s.id] = el;\r\n              }}\r\n              onClick={() =>\r\n                setOpenPicker(openPicker === s.id ? null : s.id)\r\n              }\r\n              className=\"w-4 h-4 rounded-full border border-white/30 mx-1\"\r\n              style={{ backgroundColor: s.color }}\r\n              title=\"Change color\"\r\n            />\r\n\r\n            {/* üëÅÔ∏è Visibility toggle */}\r\n            <button\r\n              onClick={() => toggle(s.id)}\r\n              className={`px-1 rounded border ${\r\n                visible[s.id]\r\n                  ? \"border-white/20 hover:bg-white/10\"\r\n                  : \"border-white/10 text-white/50 hover:bg-white/5\"\r\n              }`}\r\n            >\r\n              {visible[s.id] ? \"üëÅ\" : \"üö´\"}\r\n            </button>\r\n\r\n            {/* üóë Delete */}\r\n            <button\r\n              onClick={() => deleteSolution(s.id)}\r\n              className=\"px-1 rounded border border-red-400/40 text-red-300 hover:bg-red-400/20\"\r\n            >\r\n              ‚úï\r\n            </button>\r\n\r\n            {/* üé® Floating color picker */}\r\n            {openPicker === s.id && (\r\n              <ColorPickerPortal\r\n                anchorRef={{ current: btnRefs.current[s.id] as HTMLElement }}\r\n                color={s.color}\r\n                onChange={(c) => recolorSolution?.(s.id, c)}\r\n                onClose={() => setOpenPicker(null)}\r\n              />\r\n            )}\r\n          </div>\r\n        ))}\r\n\r\n        {solutions.length === 0 && (\r\n          <div className=\"text-white/50 text-xs\">No solutions loaded.</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 426, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/utils/constants.ts"],"sourcesContent":["export const SYSTEM_NAME = \"Altaira System\";\r\n\r\n/* ===================== Universal Constants ===================== */\r\nexport const AU_KM = 149_597_870.691;        // kilometers per astronomical unit\r\nexport const SECONDS_PER_DAY = 86_400;       // seconds per day\r\nexport const DAYS_PER_YEAR = 365.25;         // mean solar days per year\r\nexport const ALTAIRA_GM = 139_348_062_043.343; // km¬≥/s¬≤ (gravitational parameter)\r\n\r\n/* ===================== Time References ===================== */\r\nexport const JD_SIM_START = 0;          // synthetic epoch for GTOC13 simulation\r\nexport const JD_EPOCH_0 = 2451545.0;    // reference epoch (display anchor only)\r\nexport const MILISECONDS_PER_DAY = 86_400_000;\r\n\r\n/* ===================== Solar Sail Parameters ===================== */\r\nexport const SAIL = {\r\n  FLUX_1AU: 5.4026e-6,  // N/m¬≤\r\n  AREA: 15_000,         // m¬≤\r\n  MASS: 500,            // kg\r\n} as const;\r\n\r\n/* ===================== Competition Parameters ===================== */\r\nexport const COMPETITION = {\r\n  MAX_YEARS: 200,\r\n  MIN_PERIHELION: 0.01, // AU\r\n  MAX_PERIHELION: 0.05, // AU\r\n} as const;\r\n\r\n/* ===================== Body Scientific Weights ===================== */\r\nexport const BODY_WEIGHTS: Record<number | string, number> = {\r\n  1: 0.1,    // Vulcan\r\n  2: 1,      // Yavin\r\n  3: 2,      // Eden\r\n  4: 3,      // Hoth\r\n  1000: 5,   // Yandi\r\n  5: 7,      // Beyonc√©\r\n  6: 10,     // Bespin\r\n  7: 15,     // Jotunn\r\n  8: 20,     // Wakonyingo\r\n  9: 35,     // Rogue 1\r\n  10: 50,    // Planet X\r\n  ASTEROIDS: 1,\r\n  COMETS: 3,\r\n};\r\n\r\n/* ===================== Time Bonus Parameters ===================== */\r\nexport const TIME_BONUS = {\r\n  EARLY: 1.13,\r\n  LATE_SLOPE: -0.005,\r\n  LATE_INTERCEPT: 1.165,\r\n} as const;\r\n\r\n/* ===================== Visualization Colors ===================== */\r\nexport const TYPE_COLORS: Record<\"Planet\" | \"Asteroid\" | \"Comet\", string> = {\r\n  Planet:  \"#6aa6ff\",\r\n  Asteroid:\"#bfbfbf\",\r\n  Comet:   \"#a0ffa0\",\r\n};\r\n\r\n/* ===================== Export Bundle ===================== */\r\nexport const CONSTANTS = {\r\n  AU_KM,\r\n  SECONDS_PER_DAY,\r\n  DAYS_PER_YEAR,\r\n  ALTAIRA_GM,\r\n  SAIL,\r\n  COMPETITION,\r\n  BODY_WEIGHTS,\r\n  TIME_BONUS,\r\n} as const;\r\n\r\nexport type Constants = typeof CONSTANTS;\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,MAAM,cAAc;AAGpB,MAAM,QAAQ,iBAAwB,mCAAmC;AACzE,MAAM,kBAAkB,QAAc,kBAAkB;AACxD,MAAM,gBAAgB,QAAgB,2BAA2B;AACjE,MAAM,aAAa,qBAAqB,mCAAmC;AAG3E,MAAM,eAAe,GAAY,wCAAwC;AACzE,MAAM,aAAa,WAAc,wCAAwC;AACzE,MAAM,sBAAsB;AAG5B,MAAM,OAAO;IAClB,UAAU;IACV,MAAM;IACN,MAAM;AACR;AAGO,MAAM,cAAc;IACzB,WAAW;IACX,gBAAgB;IAChB,gBAAgB;AAClB;AAGO,MAAM,eAAgD;IAC3D,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,MAAM;IACN,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,IAAI;IACJ,WAAW;IACX,QAAQ;AACV;AAGO,MAAM,aAAa;IACxB,OAAO;IACP,YAAY,CAAC;IACb,gBAAgB;AAClB;AAGO,MAAM,cAA+D;IAC1E,QAAS;IACT,UAAS;IACT,OAAS;AACX;AAGO,MAAM,YAAY;IACvB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AACF","debugId":null}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/solutions/SolutionPath.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useMemo, useState } from \"react\";\r\nimport * as THREE from \"three\";\r\nimport { Line } from \"@react-three/drei\";\r\nimport { AU_KM, SECONDS_PER_DAY } from \"@/components/gtoc/utils/constants\";\r\nimport { Solution } from \"./types\";\r\n\r\n/* ---------- Hover payload type ---------- */\r\nexport type HoverPayload = {\r\n  solutionName: string;\r\n  color: string;\r\n  legIndex: number;\r\n  fromBody?: number | null;\r\n  toBody?: number | null;\r\n  tofDays: number;\r\n};\r\n\r\n/* ---------- Props ---------- */\r\ntype Props = {\r\n  sol: Solution;\r\n  currentJD: number;\r\n  epochZeroJD: number;\r\n  showShip?: boolean;\r\n  onHover?: (data: HoverPayload, x: number, y: number) => void;\r\n  onUnhover?: () => void;\r\n};\r\n\r\n/* ============================================================= */\r\nexport default function SolutionPath({\r\n  sol,\r\n  currentJD,\r\n  epochZeroJD,\r\n  showShip,\r\n  onHover,\r\n  onUnhover,\r\n}: Props) {\r\n  if (!sol?.samples?.length) return null;\r\n\r\n  // --- Detect AU vs km ---\r\n  const medianR = (() => {\r\n    const mags = sol.samples\r\n      .map((s) => Math.hypot(...s.p))\r\n      .filter((m) => Number.isFinite(m))\r\n      .sort((a, b) => a - b);\r\n    return mags[Math.floor(mags.length / 2)] || 1;\r\n  })();\r\n  const SCALE = medianR > 1e3 ? 1 / AU_KM : 1;\r\n\r\n  // --- Convert to 3D points ---\r\n  const pts = useMemo(\r\n    () =>\r\n      sol.samples\r\n        .map((s) => new THREE.Vector3(...s.p).multiplyScalar(SCALE))\r\n        .filter(\r\n          (v) =>\r\n            Number.isFinite(v.x) && Number.isFinite(v.y) && Number.isFinite(v.z)\r\n        ),\r\n    [sol.samples, SCALE]\r\n  );\r\n  if (pts.length < 2) return null;\r\n\r\n  // --- Continuous progress interpolation ---\r\n  const elapsed = (currentJD - epochZeroJD) * SECONDS_PER_DAY;\r\n  const times = sol.samples.map((s) => s.t);\r\n\r\n  let idx = times.findIndex((t, i) => elapsed >= t && elapsed <= times[i + 1]);\r\n  if (idx < 0) idx = Math.max(0, times.length - 2);\r\n\r\n  const t0 = times[idx];\r\n  const t1 = times[idx + 1];\r\n  const a = t1 > t0 ? (elapsed - t0) / (t1 - t0) : 0;\r\n\r\n  const shipPos = pts[idx].clone().lerp(pts[idx + 1], a);\r\n  const visiblePts = [...pts.slice(0, idx + 1), shipPos];\r\n\r\n  const baseColor = sol.color || \"#66d9e8\";\r\n\r\n  // --- Hovered leg state ---\r\n  const [hoveredLeg, setHoveredLeg] = useState<number | null>(null);\r\n\r\n    // --- Leg metadata (hover info) ---\r\n  const legs = useMemo(() => {\r\n      const out: {\r\n        fromBody: number;\r\n        toBody: number;\r\n        t0: number;\r\n        t1: number;\r\n        pts: THREE.Vector3[];\r\n      }[] = [];\r\n\r\n      if (!sol.samples.length) return out;\r\n\r\n      const scaled = sol.samples.map((s) => ({\r\n        t: s.t,\r\n        body: s.bodyId ?? 0,\r\n        v: new THREE.Vector3(...s.p).multiplyScalar(SCALE),\r\n      }));\r\n\r\n      let cur = {\r\n        fromBody: scaled[0].body,\r\n        toBody: scaled[0].body,\r\n        t0: scaled[0].t,\r\n        t1: scaled[0].t,\r\n        pts: [scaled[0].v],\r\n      };\r\n\r\n      for (let i = 1; i < scaled.length; i++) {\r\n        const s = scaled[i];\r\n        cur.pts.push(s.v);\r\n        cur.t1 = s.t;\r\n\r\n        // Detect a body transition\r\n        const nextBody = scaled[i + 1]?.body ?? s.body;\r\n        if (nextBody !== s.body) {\r\n          // Find the next distinct body ahead to serve as destination\r\n          const toBody =\r\n            scaled\r\n              .slice(i + 1)\r\n              .map((p) => p.body)\r\n              .find((b) => b !== s.body) ?? s.body;\r\n\r\n          cur.toBody = toBody;\r\n          out.push(cur);\r\n\r\n          // Start new leg\r\n          cur = {\r\n            fromBody: s.body,\r\n            toBody,\r\n            t0: s.t,\r\n            t1: s.t,\r\n            pts: [],\r\n          };\r\n        }\r\n      }\r\n\r\n      // Push the last leg if valid\r\n      if (cur.pts.length > 0) out.push(cur);\r\n\r\n      return out;\r\n    }, [sol.samples, SCALE]);\r\n\r\n\r\n  /* ============================================================= */\r\n  return (\r\n    <group>\r\n      {/* thin dashed outline of full orbit */}\r\n      <Line\r\n        points={pts}\r\n        color={baseColor}\r\n        lineWidth={0.2}\r\n        dashed\r\n        dashSize={0.02}\r\n        gapSize={0.02}\r\n        transparent\r\n        opacity={0.25}\r\n        toneMapped={false}\r\n      />\r\n\r\n      {/* visible trajectory so far */}\r\n      <Line\r\n        key={`${sol.id}-progress`}\r\n        points={visiblePts}\r\n        color={baseColor}\r\n        lineWidth={1.8}\r\n        transparent\r\n        opacity={0.95}\r\n        toneMapped={false}\r\n      />\r\n\r\n      {/* spacecraft marker */}\r\n      {showShip && (\r\n        <mesh position={shipPos}>\r\n          <sphereGeometry args={[0.05, 32, 32]} />\r\n          <meshBasicMaterial color={baseColor} toneMapped={false} />\r\n        </mesh>\r\n      )}\r\n\r\n      {/* hoverable legs + highlight */}\r\n      {legs.map((leg, i) => {\r\n        const tofDays = (leg.t1 - leg.t0) / SECONDS_PER_DAY;\r\n        const isHovered = hoveredLeg === i;\r\n\r\n        return (\r\n          <group key={`${sol.id}-leg-${i}`}>\r\n            {/* ‚ú® bright highlight when hovered */}\r\n            {isHovered && (\r\n              <Line\r\n                points={leg.pts}\r\n                color={baseColor}\r\n                lineWidth={4.2}\r\n                transparent\r\n                opacity={0.9}\r\n                toneMapped={false}\r\n              />\r\n            )}\r\n\r\n            {/* invisible hit zone for hover detection */}\r\n            <Line\r\n              points={leg.pts}\r\n              color={baseColor}\r\n              lineWidth={3.5}\r\n              transparent\r\n              opacity={0}\r\n              toneMapped={false}\r\n              onPointerOver={(e) => {\r\n                e.stopPropagation();\r\n                setHoveredLeg(i);\r\n                onHover?.(\r\n                  {\r\n                    solutionName: sol.name,\r\n                    color: baseColor,\r\n                    legIndex: i + 1,\r\n                    fromBody: leg.fromBody,\r\n                    toBody: leg.toBody,\r\n                    tofDays,\r\n                  },\r\n                  e.clientX,\r\n                  e.clientY\r\n                );\r\n              }}\r\n              onPointerOut={(e) => {\r\n                e.stopPropagation();\r\n                setHoveredLeg(null);\r\n                onUnhover?.();\r\n              }}\r\n            />\r\n          </group>\r\n        );\r\n      })}\r\n    </group>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 751, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/solutions/Solutions3D.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { useSolutions } from \"./useSolutions\";\r\nimport SolutionPath, { HoverPayload } from \"./SolutionPath\";\r\n\r\nexport default function Solutions3D({\r\n  currentJD,\r\n  epochZeroJD,\r\n  showShip,\r\n  onHover,\r\n  onUnhover,\r\n}: {\r\n  currentJD: number;\r\n  epochZeroJD: number;\r\n  showShip?: boolean;\r\n  onHover?: (data: HoverPayload, x: number, y: number) => void;\r\n  onUnhover?: () => void;\r\n}) {\r\n  const { solutions, visible } = useSolutions();\r\n\r\n  return (\r\n    <>\r\n      {solutions.map(\r\n        (s) =>\r\n          visible[s.id] && (\r\n            <SolutionPath\r\n              key={s.id}\r\n              sol={s}\r\n              currentJD={currentJD}\r\n              epochZeroJD={epochZeroJD}\r\n              showShip={showShip}\r\n              onHover={onHover}\r\n              onUnhover={onUnhover}\r\n            />\r\n          )\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;;;AAJA;;;AAMe,SAAS,YAAY,EAClC,SAAS,EACT,WAAW,EACX,QAAQ,EACR,OAAO,EACP,SAAS,EAOV;;IACC,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,IAAA,yKAAY;IAE3C,qBACE;kBACG,UAAU,GAAG,CACZ,CAAC,IACC,OAAO,CAAC,EAAE,EAAE,CAAC,kBACX,6LAAC,qKAAY;gBAEX,KAAK;gBACL,WAAW;gBACX,aAAa;gBACb,UAAU;gBACV,SAAS;gBACT,WAAW;eANN,EAAE,EAAE;;;;;;AAYvB;GAjCwB;;QAaS,yKAAY;;;KAbrB","debugId":null}},
    {"offset": {"line": 796, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 805, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/solutions/index.ts"],"sourcesContent":["export { default as SolutionsUI } from \"./SolutionsUI\";\r\nexport { default as Solutions3D } from \"./Solutions3D\";\r\nexport { default as SolutionPath } from \"./SolutionPath\";\r\nexport * from \"./types\";\r\nexport * from \"./useSolutions\";\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA","debugId":null}},
    {"offset": {"line": 841, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/sceneParts/HUD.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\n\r\ntype Props = {\r\n  jd: number;\r\n  setJD: (v: number | ((prev: number) => number)) => void;\r\n  isPlaying: boolean;\r\n  setPlaying: (v: boolean) => void;\r\n  rate: number;\r\n  setRate: (v: number) => void;\r\n  jdMin: number;\r\n  jdMax: number;\r\n  milestonesJD: number[];\r\n  milestonesISO: string[];\r\n  candidates?: Array<{ id: string; name: string }>;\r\n};\r\n\r\nconst clamp = (x: number, a: number, b: number) => Math.max(a, Math.min(b, x));\r\nconst lerp = (a: number, b: number, t: number) => a + (b - a) * t;\r\n\r\nconst RAIL_HEIGHT_PX = 6;\r\nconst RAIL_BOTTOM_PX = 16;\r\nconst RAIL_CENTER_BOTTOM_PX = RAIL_BOTTOM_PX + RAIL_HEIGHT_PX / 2;\r\n\r\nfunction jdToDate(jd: number) {\r\n  const ms = (jd - 2440587.5) * 86400000;\r\n  return new Date(ms);\r\n}\r\nfunction dateToJD(d: Date) {\r\n  return d.getTime() / 86400000 + 2440587.5;\r\n}\r\nfunction jdToISO(jd: number) {\r\n  return jdToDate(jd).toISOString().replace(\".000Z\", \"Z\");\r\n}\r\nconst isoShort = (iso: string) => iso.slice(0, 10);\r\n\r\ntype Marker = { jd: number; label?: string; kind: \"start\" | \"end\" | \"major\" | \"minor\" | \"custom\" };\r\n\r\nfunction buildTimeGrid(jdMin: number, jdMax: number, custom: Marker[]): Marker[] {\r\n  const start = jdToDate(jdMin);\r\n  const end = jdToDate(jdMax);\r\n  const y0 = start.getUTCFullYear();\r\n  const y1 = end.getUTCFullYear();\r\n\r\n  const first25 = Math.floor(y0 / 25) * 25;\r\n  const last25 = Math.ceil(y1 / 25) * 25;\r\n\r\n  const grid: Marker[] = [\r\n    { jd: jdMin, label: isoShort(jdToISO(jdMin)), kind: \"start\" },\r\n    { jd: jdMax, label: isoShort(jdToISO(jdMax)), kind: \"end\" },\r\n  ];\r\n\r\n  const yearBufferJD = 365.25;\r\n  for (let y = first25; y <= last25; y += 25) {\r\n    const d = new Date(Date.UTC(y, 0, 1));\r\n    const mJD = dateToJD(d);\r\n    if (mJD <= jdMin + yearBufferJD || mJD >= jdMax - yearBufferJD) continue;\r\n    const isCentury = y % 100 === 0;\r\n    grid.push({ jd: mJD, label: String(y), kind: isCentury ? \"major\" : \"minor\" });\r\n  }\r\n\r\n  const dedupTol = (jdMax - jdMin) * 1e-4;\r\n  for (const m of custom) {\r\n    if (!grid.some((g) => Math.abs(g.jd - m.jd) < dedupTol)) grid.push(m);\r\n  }\r\n\r\n  grid.sort((a, b) => a.jd - b.jd);\r\n  return grid;\r\n}\r\n\r\n/* ---------- Icons ---------- */\r\n\r\nconst IconPlay = () => (\r\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\">\r\n    <path d=\"M7 5l12 7-12 7V5z\" fill=\"currentColor\" />\r\n  </svg>\r\n);\r\nconst IconPause = () => (\r\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\">\r\n    <path d=\"M8 6h3v12H8zM13 6h3v12h-3z\" fill=\"currentColor\" />\r\n  </svg>\r\n);\r\nconst IconPrev = () => (\r\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\">\r\n    <path d=\"M7 6h2v12H7zM21 18L9 12l12-6v12z\" fill=\"currentColor\" />\r\n  </svg>\r\n);\r\nconst IconNext = () => (\r\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\">\r\n    <path d=\"M15 6h2v12h-2zM3 18l12-6L3 6v12z\" fill=\"currentColor\" />\r\n  </svg>\r\n);\r\nconst IconSpeed = () => (\r\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\">\r\n    <circle cx=\"12\" cy=\"12\" r=\"8.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" fill=\"none\" />\r\n    <path d=\"M12 12l4-4\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\r\n  </svg>\r\n);\r\nconst IconCalendar = () => (\r\n  <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\">\r\n    <rect x=\"3\" y=\"5\" width=\"18\" height=\"16\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"1.5\" fill=\"none\" />\r\n    <path d=\"M8 3v4M16 3v4M3 10h18\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Heads-Up Display (HUD) for time control and mission timeline.\r\n * Provides interactive JD scrubbing, playback, and time-step control.\r\n */\r\nexport default function HUD({\r\n  jd,\r\n  setJD,\r\n  isPlaying,\r\n  setPlaying,\r\n  rate,\r\n  setRate,\r\n  jdMin,\r\n  jdMax,\r\n  milestonesJD,\r\n  milestonesISO,\r\n}: Props) {\r\n  const railRef = useRef<HTMLDivElement>(null);\r\n  const knobRef = useRef<HTMLDivElement>(null);\r\n  const [isScrubbing, setScrubbing] = useState(false);\r\n  const [stepDays, setStepDays] = useState(rate);\r\n\r\n  useEffect(() => setStepDays(rate), [rate]);\r\n\r\n  const pct = useMemo(\r\n    () => (jdMax > jdMin ? ((jd - jdMin) / (jdMax - jdMin)) * 100 : 0),\r\n    [jd, jdMin, jdMax]\r\n  );\r\n\r\n  const customMarkers = useMemo<Marker[]>(\r\n    () =>\r\n      milestonesJD.map((mjd, i) => ({\r\n        jd: mjd,\r\n        label: milestonesISO[i],\r\n        kind: \"custom\" as const,\r\n      })),\r\n    [milestonesJD, milestonesISO]\r\n  );\r\n\r\n  const markers = useMemo(\r\n    () => buildTimeGrid(jdMin, jdMax, customMarkers),\r\n    [jdMin, jdMax, customMarkers]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (knobRef.current) knobRef.current.tabIndex = 0;\r\n  }, []);\r\n\r\n  const updateFromClientX = useCallback(\r\n    (clientX: number) => {\r\n      const rail = railRef.current;\r\n      if (!rail) return;\r\n      const rect = rail.getBoundingClientRect();\r\n      const p = clamp((clientX - rect.left) / rect.width, 0, 1);\r\n      setJD(lerp(jdMin, jdMax, p));\r\n    },\r\n    [jdMin, jdMax, setJD]\r\n  );\r\n\r\n  const onPointerDownRail = (e: React.PointerEvent) => {\r\n    (e.currentTarget as HTMLElement).setPointerCapture(e.pointerId);\r\n    setScrubbing(true);\r\n    updateFromClientX(e.clientX);\r\n  };\r\n  const onPointerMoveRail = (e: React.PointerEvent) => {\r\n    if (isScrubbing) updateFromClientX(e.clientX);\r\n  };\r\n  const onPointerUpRail = (e: React.PointerEvent) => {\r\n    (e.currentTarget as HTMLElement).releasePointerCapture(e.pointerId);\r\n    setScrubbing(false);\r\n  };\r\n\r\n  const onWheel = (e: React.WheelEvent) => {\r\n    e.preventDefault();\r\n    const delta = (jdMax - jdMin) * (e.deltaY < 0 ? -0.0015 : 0.0015);\r\n    setJD((prev) => clamp(prev + delta, jdMin, jdMax));\r\n  };\r\n\r\n  const onKeyDownKnob = (e: React.KeyboardEvent) => {\r\n    if (e.key === \"ArrowLeft\") setJD((prev) => clamp(prev - stepDays, jdMin, jdMax));\r\n    else if (e.key === \"ArrowRight\") setJD((prev) => clamp(prev + stepDays, jdMin, jdMax));\r\n    else if (e.key === \" \") {\r\n      e.preventDefault();\r\n      setPlaying(!isPlaying);\r\n    }\r\n  };\r\n\r\n  const jumpTo = (mjd: number) => setJD(clamp(mjd, jdMin, jdMax));\r\n  const leftPct = (mjd: number) => (jdMax > jdMin ? ((mjd - jdMin) / (jdMax - jdMin)) * 100 : 0);\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed inset-x-0 bottom-0 z-[9999] pb-[max(env(safe-area-inset-bottom),0px)] text-white select-none\"\r\n      role=\"region\"\r\n      aria-label=\"Time controls\"\r\n    >\r\n      {/* Timeline markers */}\r\n      <div className=\"max-w-[1400px] mx-auto px-4 pt-1\">\r\n        <div className=\"relative\" style={{ height: 40 + RAIL_CENTER_BOTTOM_PX }}>\r\n          <div className=\"absolute inset-x-0\" style={{ bottom: RAIL_CENTER_BOTTOM_PX, height: 0 }}>\r\n            {markers.map(({ jd: mjd, label, kind }, i) => {\r\n              const pos = leftPct(mjd);\r\n              const isCustom = kind === \"custom\";\r\n              const isStart = kind === \"start\";\r\n              const isEnd = kind === \"end\";\r\n              const tickDown = 6;\r\n              const tickColor = isStart || isEnd ? \"bg-white\" : isCustom ? \"bg-emerald-300\" : \"bg-white/65\";\r\n              const textColor = isCustom\r\n                ? \"text-emerald-200\"\r\n                : isStart || isEnd\r\n                ? \"text-white/90\"\r\n                : \"text-white/70\";\r\n\r\n              const text =\r\n                label ??\r\n                (isStart || isEnd\r\n                  ? isoShort(jdToISO(mjd))\r\n                  : String(jdToDate(mjd).getUTCFullYear()));\r\n\r\n              return (\r\n                <div\r\n                  key={`${kind}-${i}-${mjd}`}\r\n                  className=\"absolute -translate-x-1/2\"\r\n                  style={{ left: `${pos}%` }}\r\n                >\r\n                  <div className={`w-[1px] ${tickColor}`} style={{ height: tickDown }} />\r\n                  <div\r\n                    className={`absolute left-1/2 -translate-x-1/2 -translate-y-[calc(100%-4px)] text-[10px] leading-3 whitespace-nowrap ${textColor}`}\r\n                    style={{ bottom: tickDown }}\r\n                    title={text}\r\n                  >\r\n                    {text}\r\n                  </div>\r\n                  <button\r\n                    className=\"absolute -left-2 -top-6 w-4 h-[28px] pointer-events-auto\"\r\n                    title={label ?? jdToISO(mjd)}\r\n                    aria-label={`Jump to ${label ?? jdToISO(mjd)}`}\r\n                    onClick={() => jumpTo(mjd)}\r\n                  />\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Timeline rail */}\r\n      <div className=\"max-w-[1400px] mx-auto px-4\">\r\n        <div ref={railRef} className=\"relative cursor-pointer\" style={{ height: RAIL_BOTTOM_PX + RAIL_HEIGHT_PX }}>\r\n          <div\r\n            className=\"absolute inset-x-0 rounded-full bg-white/12 hover:bg-white/16 transition-colors\"\r\n            style={{ bottom: RAIL_BOTTOM_PX, height: RAIL_HEIGHT_PX }}\r\n            onPointerDown={onPointerDownRail}\r\n            onPointerMove={onPointerMoveRail}\r\n            onPointerUp={onPointerUpRail}\r\n            onWheel={onWheel}\r\n          >\r\n            <div className=\"absolute inset-y-0 left-0 rounded-l-full bg-white/35\" style={{ width: `${pct}%` }} />\r\n            <div\r\n              ref={knobRef}\r\n              className=\"absolute top-1/2 -translate-y-1/2 h-3 w-3 rounded-full bg-white shadow ring-2 ring-black/30\"\r\n              style={{ left: `calc(${pct}% - 6px)` }}\r\n              tabIndex={0}\r\n              onKeyDown={onKeyDownKnob}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Control bar */}\r\n      <div className=\"max-w-[1400px] mx-auto px-4 pb-2\">\r\n        <div className=\"grid grid-cols-[1fr_auto_1fr] items-center gap-4\">\r\n          <div className=\"flex items-center gap-3 min-w-0\">\r\n            <div className=\"flex items-center gap-2 text-sm text-white/90\">\r\n              <IconCalendar />\r\n              <span className=\"tabular-nums\">{isoShort(jdToISO(jd))}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-center gap-2\">\r\n            <button\r\n              onClick={() => setJD((p) => clamp(p - stepDays, jdMin, jdMax))}\r\n              className=\"h-8 px-2 rounded-md border border-white/15 hover:bg-white/10 text-white/90\"\r\n            >\r\n              <IconPrev />\r\n            </button>\r\n            <button\r\n              onClick={() => setPlaying(!isPlaying)}\r\n              className=\"h-8 w-8 rounded-full bg-white/20 hover:bg-white/30 border border-white/25 flex items-center justify-center\"\r\n            >\r\n              {isPlaying ? <IconPause /> : <IconPlay />}\r\n            </button>\r\n            <button\r\n              onClick={() => setJD((p) => clamp(p + stepDays, jdMin, jdMax))}\r\n              className=\"h-8 px-2 rounded-md border border-white/15 hover:bg-white/10 text-white/90\"\r\n            >\r\n              <IconNext />\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-end gap-4\">\r\n            <div className=\"hidden md:flex items-center gap-2 text-white/90\">\r\n              <IconSpeed />\r\n              <input\r\n                type=\"range\"\r\n                min={1}\r\n                max={1000}\r\n                step={1}\r\n                value={clamp(Math.round(rate), 1, 1000)}\r\n                onChange={(e) => setRate(parseInt(e.target.value, 10))}\r\n                className=\"w-48 accent-white\"\r\n              />\r\n            </div>\r\n            <div className=\"hidden sm:flex items-center gap-2 text-xs text-white/80\">\r\n              <span>Step</span>\r\n              <input\r\n                type=\"number\"\r\n                className=\"w-25 bg-transparent border border-white/15 rounded px-2 py-1 text-right [color-scheme:dark] text-white tracking-wide\"\r\n                min={1}\r\n                max={3650}\r\n                value={stepDays}\r\n                onChange={(e) => {\r\n                  const newVal = clamp(parseInt(e.target.value || \"1\", 10), 1, 3650);\r\n                  setStepDays(newVal);\r\n                  setRate(newVal);\r\n                }}\r\n              />\r\n              <span>d</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1469, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/sceneParts/BodyPoint.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useRef, useState, useMemo } from \"react\";\r\nimport * as THREE from \"three\";\r\nimport { useFrame, useThree } from \"@react-three/fiber\";\r\nimport { Html } from \"@react-three/drei\";\r\nimport type { Body } from \"@/components/gtoc/utils/dataLoader\";\r\nimport { JD_EPOCH_0 } from \"@/components/gtoc/utils/constants\";\r\n\r\n/**\r\n * Builds rotation matrix from perifocal (PQW) to inertial coordinates given Œ©, i, œâ [rad].\r\n * R = Rz(Œ©) * Rx(i) * Rz(œâ)\r\n */\r\nfunction pqwToIJK(Œ©: number, i: number, œâ: number) {\r\n  const cO = Math.cos(Œ©),\r\n    sO = Math.sin(Œ©);\r\n  const ci = Math.cos(i),\r\n    si = Math.sin(i);\r\n  const cw = Math.cos(œâ),\r\n    sw = Math.sin(œâ);\r\n\r\n  return new THREE.Matrix3().set(\r\n    cO * cw - sO * sw * ci,\r\n    -cO * sw - sO * cw * ci,\r\n    sO * si,\r\n    sO * cw + cO * sw * ci,\r\n    -sO * sw + cO * cw * ci,\r\n    -cO * si,\r\n    sw * si,\r\n    cw * si,\r\n    ci\r\n  );\r\n}\r\n\r\n/**\r\n * Solves Kepler‚Äôs equation M = E ‚àí e¬∑sinE for 0 ‚â§ e < 1 using fixed-point iteration.\r\n */\r\nfunction solveE(M: number, e: number) {\r\n  const Mp = Math.atan2(Math.sin(M), Math.cos(M));\r\n  let E = Mp;\r\n  for (let k = 0; k < 8; k++) E = Mp + e * Math.sin(E);\r\n  return E;\r\n}\r\n\r\n/**\r\n * Renders a single celestial body with live orbital propagation and optional label.\r\n * Shows hover info and highlights orbit when selected.\r\n */\r\nexport default function BodyPoint({\r\n  body,\r\n  jd,\r\n  showLabel = false,\r\n}: {\r\n  body: Body;\r\n  jd: number;\r\n  showLabel?: boolean;\r\n}) {\r\n  const meshRef = useRef<THREE.Group>(null!);\r\n  const { camera } = useThree();\r\n  const [isHovered, setHovered] = useState(false);\r\n\r\n  const displayName = body.name && body.name !== \"None\" ? body.name : `#${body.id}`;\r\n\r\n  const e = Number.isFinite(body.e) ? body.e : 0;\r\n  const a_AU = Number.isFinite(body.a_AU) ? Math.max(1e-6, body.a_AU) : 1;\r\n  const Œ© = Number.isFinite(body.Omega) ? body.Omega : 0;\r\n  const i = Number.isFinite(body.inc) ? body.inc : 0;\r\n  const œâ = Number.isFinite(body.omega) ? body.omega : 0;\r\n  const M0 = Number.isFinite(body.M0) ? body.M0 : 0;\r\n  const epochJD = Number.isFinite((body as any).epoch_JD) ? (body as any).epoch_JD : JD_EPOCH_0;\r\n\r\n  const R = useMemo(() => pqwToIJK(Œ©, i, œâ), [Œ©, i, œâ]);\r\n\r\n  const orbitGeom = useMemo(() => {\r\n    if (e >= 1) return null;\r\n    const segments = 256;\r\n    const pts: THREE.Vector3[] = [];\r\n\r\n    for (let k = 0; k <= segments; k++) {\r\n      const M = (2 * Math.PI * k) / segments;\r\n      const E = solveE(M, e);\r\n      const r = a_AU * (1 - e * Math.cos(E));\r\n      const cosŒΩ = (Math.cos(E) - e) / (1 - e * Math.cos(E));\r\n      const sinŒΩ = (Math.sqrt(1 - e * e) * Math.sin(E)) / (1 - e * Math.cos(E));\r\n      const x_p = r * cosŒΩ;\r\n      const y_p = r * sinŒΩ;\r\n      const v = new THREE.Vector3(x_p, y_p, 0).applyMatrix3(R);\r\n      pts.push(v);\r\n    }\r\n\r\n    return new THREE.BufferGeometry().setFromPoints(pts);\r\n  }, [a_AU, e, R]);\r\n\r\n  useFrame(() => {\r\n    if (!meshRef.current) return;\r\n    const n = (2 * Math.PI) / (Math.sqrt(a_AU ** 3) * 365.25); // mean motion [rad/day]\r\n    const M = M0 + n * (jd - epochJD);\r\n    const E = solveE(M, e);\r\n\r\n    const r = a_AU * (1 - e * Math.cos(E));\r\n    const cosŒΩ = (Math.cos(E) - e) / (1 - e * Math.cos(E));\r\n    const sinŒΩ = (Math.sqrt(1 - e * e) * Math.sin(E)) / (1 - e * Math.cos(E));\r\n    const x_p = r * cosŒΩ;\r\n    const y_p = r * sinŒΩ;\r\n    const pos = new THREE.Vector3(x_p, y_p, 0).applyMatrix3(R);\r\n    meshRef.current.position.copy(pos);\r\n  });\r\n\r\n  const distance = camera.position.length();\r\n  const opacity = Math.max(0, 1 - distance / 15);\r\n\r\n  return (\r\n    <>\r\n      {isHovered && orbitGeom && (\r\n        <primitive\r\n          object={new THREE.Line(\r\n            orbitGeom,\r\n            new THREE.LineBasicMaterial({\r\n              color: body.color ?? \"#ffffff\",\r\n              transparent: true,\r\n              opacity: 0.7,\r\n            })\r\n          )}\r\n          frustumCulled={false}\r\n        />\r\n      )}\r\n\r\n      <group\r\n        ref={meshRef}\r\n        onPointerOver={() => setHovered(true)}\r\n        onPointerOut={() => setHovered(false)}\r\n      >\r\n        <mesh frustumCulled={false}>\r\n          <sphereGeometry args={[0.015, 16, 16]} />\r\n          <meshStandardMaterial\r\n            color={isHovered ? \"#ffd500\" : body.color ?? \"#ffffff\"}\r\n            emissive={isHovered ? \"#ffd500\" : \"#000000\"}\r\n            emissiveIntensity={isHovered ? 0.4 : 0}\r\n          />\r\n        </mesh>\r\n\r\n        {showLabel && body.type === \"Planet\" && (\r\n          <Html center position={[0, 0.05, 0]} style={{ pointerEvents: \"none\" }}>\r\n            <div\r\n              className=\"px-2 py-1 rounded-lg text-[11px] text-white/90 font-medium\r\n                         backdrop-blur-md bg-black/40 border border-white/10 shadow-md\r\n                         whitespace-nowrap select-none\"\r\n              style={{ opacity }}\r\n            >\r\n              {displayName}\r\n            </div>\r\n          </Html>\r\n        )}\r\n\r\n        {isHovered && (\r\n          <Html center position={[0, 0.08, 0]}>\r\n            <div\r\n              className=\"p-2 rounded-lg text-[11px] leading-tight text-white backdrop-blur-md \r\n                        bg-black/60 border border-white/10 shadow-lg whitespace-nowrap select-none\"\r\n            >\r\n              <div className=\"font-semibold text-[#ffd500]\">{displayName}</div>\r\n              <div className=\"text-gray-300\">{body.type}</div>\r\n              <div className=\"mt-1 text-[10px] text-gray-400\">\r\n                a={a_AU.toFixed(3)} AU<br />\r\n                e={e.toFixed(3)}<br />\r\n                i={( (i * 180) / Math.PI ).toFixed(2)}¬∞<br />\r\n                Œ©={( (Œ© * 180) / Math.PI ).toFixed(2)}¬∞<br />\r\n                œâ={( (œâ * 180) / Math.PI ).toFixed(2)}¬∞<br />\r\n                M‚ÇÄ={( (M0 * 180) / Math.PI ).toFixed(2)}¬∞\r\n              </div>\r\n            </div>\r\n          </Html>\r\n        )}\r\n      </group>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1752, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/KeplerSolver.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { useThree, useFrame } from \"@react-three/fiber\";\r\nimport { Html, Line } from \"@react-three/drei\";\r\nimport * as THREE from \"three\";\r\nimport {\r\n  TYPE_COLORS,\r\n  AU_KM,\r\n  SECONDS_PER_DAY,\r\n  ALTAIRA_GM,\r\n} from \"@/components/gtoc/utils/constants\";\r\n\r\n/* ======================= Types ======================= */\r\nexport type BodyType = \"Planet\" | \"Asteroid\" | \"Comet\";\r\n\r\nexport interface Body {\r\n  id: string;\r\n  name: string;\r\n  type: BodyType;\r\n  a_AU: number;\r\n  e: number;\r\n  inc: number;\r\n  Omega: number;\r\n  omega: number;\r\n  M0: number;\r\n  epoch_JD: number;\r\n  color?: string;\r\n}\r\n\r\nexport interface CandidateLOD {\r\n  level: 1 | 2 | 3;\r\n  path: [number, number, number][];\r\n}\r\n\r\nexport interface CandidateEvent {\r\n  tJD: number;\r\n  label: string;\r\n  bodyId: string;\r\n  vinf_kms?: number;\r\n  alt_km?: number;\r\n}\r\n\r\nexport interface Candidate {\r\n  id: string;\r\n  name: string;\r\n  lods: CandidateLOD[];\r\n  events: CandidateEvent[];\r\n  color?: string;\r\n}\r\n\r\n/* ======================= Kepler Solver ======================= */\r\n/** Solves Kepler‚Äôs equation for elliptic, parabolic, and hyperbolic orbits. */\r\nexport function solveKepler(M: number, e: number, tol = 1e-10, maxIter = 50): number {\r\n  if (e < 1) {\r\n    let E = M;\r\n    for (let k = 0; k < maxIter; k++) {\r\n      const f = E - e * Math.sin(E) - M;\r\n      const fp = 1 - e * Math.cos(E);\r\n      const d = f / fp;\r\n      E -= d;\r\n      if (Math.abs(d) < tol) break;\r\n    }\r\n    return E;\r\n  }\r\n\r\n  if (e === 1) return M; // Parabolic fallback\r\n\r\n  // Hyperbolic\r\n  let H = Math.log((2 * Math.abs(M)) / e + 1.8);\r\n  for (let k = 0; k < maxIter; k++) {\r\n    const sH = Math.sinh(H);\r\n    const cH = Math.cosh(H);\r\n    const f = e * sH - H - M;\r\n    const fp = e * cH - 1;\r\n    const d = f / fp;\r\n    H -= d;\r\n    if (Math.abs(d) < tol) break;\r\n  }\r\n  return H;\r\n}\r\n\r\n/** Computes heliocentric position in AU from orbital elements and Julian date. */\r\nexport function keplerToPositionAU(body: Body, jd: number): THREE.Vector3 {\r\n  const { a_AU, e, inc, Omega, omega, M0, epoch_JD } = body;\r\n  const a_km = a_AU * AU_KM;\r\n  const n = Math.sqrt(ALTAIRA_GM / (a_km ** 3));\r\n  const dt_s = (jd - epoch_JD) * SECONDS_PER_DAY;\r\n\r\n  let M = M0 + n * dt_s;\r\n  if (e < 1) M = ((M + Math.PI) % (2 * Math.PI)) - Math.PI;\r\n\r\n  const EorH = solveKepler(M, e);\r\n  let r_km: number, f_true: number;\r\n\r\n  if (e < 1) {\r\n    const E = EorH;\r\n    const cosE = Math.cos(E);\r\n    const sinE = Math.sin(E);\r\n    const denom = 1 - e * cosE;\r\n    r_km = a_km * denom;\r\n    const cosf = (cosE - e) / denom;\r\n    const sinf = (Math.sqrt(1 - e ** 2) * sinE) / denom;\r\n    f_true = Math.atan2(sinf, cosf);\r\n  } else {\r\n    const H = EorH;\r\n    const coshH = Math.cosh(H);\r\n    const sinhH = Math.sinh(H);\r\n    const denom = e * coshH - 1;\r\n    r_km = a_km * denom;\r\n    const cosf = (e - coshH) / denom;\r\n    const sinf = (Math.sqrt(e ** 2 - 1) * sinhH) / denom;\r\n    f_true = Math.atan2(sinf, cosf);\r\n  }\r\n\r\n  const cO = Math.cos(Omega),\r\n    sO = Math.sin(Omega),\r\n    ci = Math.cos(inc),\r\n    si = Math.sin(inc),\r\n    co = Math.cos(omega),\r\n    so = Math.sin(omega);\r\n\r\n  const R11 = cO * co - sO * so * ci;\r\n  const R12 = -cO * so - sO * co * ci;\r\n  const R21 = sO * co + cO * so * ci;\r\n  const R22 = -sO * so + cO * co * ci;\r\n  const R31 = so * si;\r\n  const R32 = co * si;\r\n\r\n  const x_peri = r_km * Math.cos(f_true);\r\n  const y_peri = r_km * Math.sin(f_true);\r\n\r\n  const x = (R11 * x_peri + R12 * y_peri) / AU_KM;\r\n  const y = (R21 * x_peri + R22 * y_peri) / AU_KM;\r\n  const z = (R31 * x_peri + R32 * y_peri) / AU_KM;\r\n\r\n  return new THREE.Vector3(x, y, z);\r\n}\r\n\r\n/* ======================= Scene Components ======================= */\r\n/** Draws a static orbital path for an elliptic body. */\r\nexport function OrbitPath({\r\n  body,\r\n  visible = true,\r\n  segments = 256,\r\n  color,\r\n}: {\r\n  body: Body;\r\n  visible?: boolean;\r\n  segments?: number;\r\n  color?: string;\r\n}) {\r\n  if (!visible) return null;\r\n\r\n  const points = useMemo(() => {\r\n    const a = body.a_AU;\r\n    const e = body.e;\r\n\r\n    if (!Number.isFinite(a) || a <= 0 || !Number.isFinite(e) || e >= 1) return [];\r\n\r\n    const pts: THREE.Vector3[] = [];\r\n    const a_km = a * AU_KM;\r\n\r\n    const cO = Math.cos(body.Omega),\r\n      sO = Math.sin(body.Omega),\r\n      ci = Math.cos(body.inc),\r\n      si = Math.sin(body.inc),\r\n      co = Math.cos(body.omega),\r\n      so = Math.sin(body.omega);\r\n\r\n    const R11 = cO * co - sO * so * ci;\r\n    const R12 = -cO * so - sO * co * ci;\r\n    const R21 = sO * co + cO * so * ci;\r\n    const R22 = -sO * so + cO * co * ci;\r\n    const R31 = so * si;\r\n    const R32 = co * si;\r\n\r\n    for (let k = 0; k <= segments; k++) {\r\n      const f = (2 * Math.PI * k) / segments;\r\n      const denom = 1 + e * Math.cos(f);\r\n      if (Math.abs(denom) < 1e-9) continue;\r\n      const r_km = (a_km * (1 - e ** 2)) / denom;\r\n\r\n      const x_peri = r_km * Math.cos(f);\r\n      const y_peri = r_km * Math.sin(f);\r\n      const x = (R11 * x_peri + R12 * y_peri) / AU_KM;\r\n      const y = (R21 * x_peri + R22 * y_peri) / AU_KM;\r\n      const z = (R31 * x_peri + R32 * y_peri) / AU_KM;\r\n\r\n      if (Number.isFinite(x + y + z)) pts.push(new THREE.Vector3(x, y, z));\r\n    }\r\n    return pts;\r\n  }, [body, segments]);\r\n\r\n  if (!points.length) return null;\r\n\r\n  return (\r\n    <Line\r\n      points={points}\r\n      lineWidth={1}\r\n      color={color ?? TYPE_COLORS[body.type]}\r\n      opacity={0.7}\r\n      transparent\r\n      raycast={() => null}\r\n    />\r\n  );\r\n}\r\n\r\n/** Displays an orbiting body with a hover tooltip and live position updates. */\r\nexport function BodyPoint({ body, jd }: { body: Body; jd: number }) {\r\n  const dotRef = useRef<THREE.Mesh>(null!);\r\n  const hitRef = useRef<THREE.Mesh>(null!);\r\n  const { camera } = useThree();\r\n  const [hovered, setHovered] = useState(false);\r\n  const [tooltip, setTooltip] = useState<{ pos: THREE.Vector3; Ldeg: number; fdeg: number } | null>(null);\r\n  const color = new THREE.Color(body.color ?? TYPE_COLORS[body.type]);\r\n\r\n  useFrame(() => {\r\n    const r = keplerToPositionAU(body, jd);\r\n    dotRef.current.position.copy(r);\r\n    hitRef.current.position.copy(r);\r\n\r\n    if (!hovered) return;\r\n\r\n    const a_km = body.a_AU * AU_KM;\r\n    const n = Math.sqrt(ALTAIRA_GM / (a_km ** 3));\r\n    const dt_s = (jd - body.epoch_JD) * SECONDS_PER_DAY;\r\n    let M = body.M0 + n * dt_s;\r\n    if (body.e < 1) M = ((M + Math.PI) % (2 * Math.PI)) - Math.PI;\r\n    const L = body.Omega + body.omega + M;\r\n\r\n    const EorH = solveKepler(M, body.e);\r\n    const f_true =\r\n      body.e < 1\r\n        ? Math.atan2(\r\n            Math.sqrt(1 - body.e ** 2) * Math.sin(EorH),\r\n            Math.cos(EorH) - body.e\r\n          )\r\n        : Math.atan2(\r\n            Math.sqrt(body.e ** 2 - 1) * Math.sinh(EorH),\r\n            body.e - Math.cosh(EorH)\r\n          );\r\n\r\n    const dir = r.clone().sub(camera.position).normalize();\r\n    const pos = r.clone().add(dir.multiplyScalar(0.06));\r\n\r\n    setTooltip({\r\n      pos,\r\n      Ldeg: THREE.MathUtils.radToDeg(L),\r\n      fdeg: THREE.MathUtils.radToDeg(f_true),\r\n    });\r\n  });\r\n\r\n  const displayName = body.name?.trim()?.length ? body.name : body.id;\r\n  const typeLabel = body.type ?? \"Body\";\r\n\r\n  return (\r\n    <group onPointerOver={() => setHovered(true)} onPointerOut={() => setHovered(false)}>\r\n      {body.type !== \"Planet\" && (\r\n        <OrbitPath\r\n          body={body}\r\n          visible={hovered}\r\n          segments={192}\r\n          color={body.color ?? TYPE_COLORS[body.type]}\r\n        />\r\n      )}\r\n\r\n      <mesh ref={hitRef}>\r\n        <sphereGeometry args={[0.035, 8, 8]} />\r\n        <meshBasicMaterial transparent opacity={0} depthWrite={false} />\r\n      </mesh>\r\n\r\n      <mesh ref={dotRef}>\r\n        <sphereGeometry args={[0.01, 16, 16]} />\r\n        <meshBasicMaterial color={color} />\r\n      </mesh>\r\n\r\n      {hovered && tooltip && (\r\n        <Html\r\n          position={tooltip.pos.toArray()}\r\n          center\r\n          sprite\r\n          distanceFactor={8}\r\n          style={{ pointerEvents: \"none\", transform: \"translate(-50%, -110%)\" }}\r\n        >\r\n          <div className=\"relative z-50 inline-block w-max\">\r\n            <div className=\"absolute inset-0 -z-10 blur-md opacity-40 rounded-2xl bg-gradient-to-br from-white/70 to-white/10\" />\r\n            <div className=\"px-3 py-2 rounded-2xl bg-white/95 text-xs shadow-lg ring-1 ring-black/5 text-black\">\r\n              <div className=\"text-[8px] uppercase tracking-wide text-zinc-500 whitespace-nowrap\">\r\n                {typeLabel}\r\n              </div>\r\n              <div className=\"text-base font-semibold leading-5 whitespace-nowrap\">\r\n                {displayName}\r\n              </div>\r\n              <div className=\"mt-1 text-[10px] text-zinc-700 whitespace-nowrap\">\r\n                Mean longitude: {tooltip.Ldeg.toFixed(2)}¬∞\r\n              </div>\r\n              <div className=\"text-[10px] text-zinc-700 whitespace-nowrap\">\r\n                True anomaly: {tooltip.fdeg.toFixed(2)}¬∞\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </Html>\r\n      )}\r\n    </group>\r\n  );\r\n}\r\n\r\n/** Renders the central Sun sphere. */\r\nexport function Sun() {\r\n  return (\r\n    <mesh>\r\n      <sphereGeometry args={[0.05, 32, 32]} />\r\n      <meshBasicMaterial color=\"#ffcc66\" />\r\n    </mesh>\r\n  );\r\n}\r\n\r\n/** Draws RGB axes for scene orientation. */\r\nexport function Axes({ size = 1.0 }: { size?: number }) {\r\n  return (\r\n    <group>\r\n      <Line points={[new THREE.Vector3(0, 0, 0), new THREE.Vector3(size, 0, 0)]} color=\"#ff5555\" lineWidth={1} />\r\n      <Line points={[new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, size, 0)]} color=\"#55ff55\" lineWidth={1} />\r\n      <Line points={[new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, size)]} color=\"#5555ff\" lineWidth={1} />\r\n    </group>\r\n  );\r\n}\r\n\r\n/** Initializes the camera position at scene load. */\r\nexport function CameraRig() {\r\n  const { camera } = useThree();\r\n  useEffect(() => {\r\n    camera.position.set(0, 0, 3.5);\r\n  }, [camera]);\r\n  return null;\r\n}\r\n\r\n/** Selects the appropriate LOD for a candidate based on camera distance. */\r\nexport function useCandidateLOD(candidate: Candidate) {\r\n  const { camera } = useThree();\r\n  return useMemo(() => {\r\n    const sphere = new THREE.Sphere(new THREE.Vector3(), 0);\r\n    const all = candidate.lods[candidate.lods.length - 1].path;\r\n    for (const p of all) sphere.expandByPoint(new THREE.Vector3().fromArray(p));\r\n    const d = camera.position.distanceTo(sphere.center) - sphere.radius;\r\n    if (d > 10) return candidate.lods.find(l => l.level === 3)!;\r\n    if (d > 3) return candidate.lods.find(l => l.level === 2)!;\r\n    return candidate.lods.find(l => l.level === 1)!;\r\n  }, [candidate, camera.position.x, camera.position.y, camera.position.z]);\r\n}\r\n\r\n/** Displays a labeled event marker near its associated body. */\r\nexport function EventBillboard({\r\n  event,\r\n  jd,\r\n  bodies,\r\n}: {\r\n  event: CandidateEvent;\r\n  jd: number;\r\n  bodies: Body[];\r\n}) {\r\n  const show = Math.abs(jd - event.tJD) < 30;\r\n  if (!show) return null;\r\n  const body = bodies.find(b => b.id === event.bodyId);\r\n  const pos = body ? keplerToPositionAU(body, event.tJD) : new THREE.Vector3();\r\n\r\n  return (\r\n    <group position={pos.toArray()}>\r\n      <mesh>\r\n        <sphereGeometry args={[0.012, 8, 8]} />\r\n        <meshBasicMaterial color=\"#ffffff\" />\r\n      </mesh>\r\n      <Html center distanceFactor={8} style={{ pointerEvents: \"auto\" }}>\r\n        <div className=\"px-2 py-1 rounded-xl bg-white/90 text-xs shadow border border-gray-200\">\r\n          <strong>{event.label}</strong>\r\n          {event.vinf_kms != null && <div>V‚àû: {event.vinf_kms.toFixed(1)} km/s</div>}\r\n          {event.alt_km != null && <div>Alt: {event.alt_km.toFixed(0)} km</div>}\r\n        </div>\r\n      </Html>\r\n    </group>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2333, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/utils/dataLoader.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport * as THREE from \"three\";\r\nimport { AU_KM, JD_EPOCH_0 } from \"@/components/gtoc/utils/constants\";\r\n\r\nexport type BodyType = \"Planet\" | \"Asteroid\" | \"Comet\";\r\n\r\nexport interface Body {\r\n  id: string;\r\n  name: string;\r\n  type: BodyType;\r\n  a_AU: number;\r\n  e: number;\r\n  inc: number;\r\n  Omega: number;\r\n  omega: number;\r\n  M0: number;\r\n  epoch_JD: number;\r\n  color?: string;\r\n}\r\n\r\n/**\r\n * Loads and parses a GTOC13 body catalog from CSV.\r\n * Returns an array of bodies with orbital elements normalized to AU and radians.\r\n */\r\nexport function useBodiesFromGTOCCSV(\r\n  url: string,\r\n  keepTypes: BodyType[] = [\"Planet\", \"Asteroid\", \"Comet\"]\r\n) {\r\n  const [bodies, setBodies] = useState<Body[] | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    (async () => {\r\n      try {\r\n        const resp = await fetch(url, { cache: \"no-store\" });\r\n        if (!resp.ok) throw new Error(`HTTP ${resp.status} loading ${url}`);\r\n\r\n        const text = await resp.text();\r\n        const lines = text\r\n          .split(/\\r?\\n/)\r\n          .map(l => l.trim())\r\n          .filter(Boolean);\r\n\r\n        if (lines.length < 2) throw new Error(\"CSV missing data rows.\");\r\n\r\n        const header = lines[0].split(\",\").map(h => h.trim());\r\n        const out: Body[] = [];\r\n\r\n        for (let i = 1; i < lines.length; i++) {\r\n          const cells = lines[i].split(\",\").map(c => c.trim());\r\n          if (cells.length !== header.length) continue;\r\n\r\n          const rec: Record<string, string> = {};\r\n          for (let j = 0; j < header.length; j++) rec[header[j]] = cells[j];\r\n\r\n          const type = (rec[\"Type\"] ?? \"Asteroid\") as BodyType;\r\n          if (!keepTypes.includes(type)) continue;\r\n\r\n          const a_km = Number(rec[\"a\"]);\r\n          const e = Number(rec[\"e\"]);\r\n          const iDeg = Number(rec[\"i\"]);\r\n          const ODeg = Number(rec[\"Omega\"]);\r\n          const wDeg = Number(rec[\"omega\"]);\r\n          const MDeg = Number(rec[\"M\"]);\r\n\r\n          if ([a_km, e, iDeg, ODeg, wDeg, MDeg].some(v => !Number.isFinite(v))) continue;\r\n\r\n          out.push({\r\n            id: rec[\"ID\"] || `body-${i}`,\r\n            name: rec[\"Name\"] || `Body ${i}`,\r\n            type,\r\n            a_AU: a_km / AU_KM,\r\n            e,\r\n            inc: THREE.MathUtils.degToRad(iDeg),\r\n            Omega: THREE.MathUtils.degToRad(ODeg),\r\n            omega: THREE.MathUtils.degToRad(wDeg),\r\n            M0: THREE.MathUtils.degToRad(MDeg),\r\n            epoch_JD: JD_EPOCH_0,\r\n          });\r\n        }\r\n\r\n        if (!cancelled) {\r\n          setBodies(out);\r\n          setError(null);\r\n        }\r\n      } catch (err: any) {\r\n        if (!cancelled) {\r\n          setBodies(null);\r\n          setError(err.message ?? String(err));\r\n        }\r\n      }\r\n    })();\r\n\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [url, JSON.stringify(keepTypes)]);\r\n\r\n  return { bodies, error };\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AA0BO,SAAS,qBACd,GAAW,EACX,YAAwB;IAAC;IAAU;IAAY;CAAQ;;IAEvD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAgB;IACpD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,IAAA,0KAAS;0CAAC;YACR,IAAI,YAAY;YAEhB;kDAAC;oBACC,IAAI;wBACF,MAAM,OAAO,MAAM,MAAM,KAAK;4BAAE,OAAO;wBAAW;wBAClD,IAAI,CAAC,KAAK,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,KAAK,EAAE,KAAK,MAAM,CAAC,SAAS,EAAE,KAAK;wBAElE,MAAM,OAAO,MAAM,KAAK,IAAI;wBAC5B,MAAM,QAAQ,KACX,KAAK,CAAC,SACN,GAAG;oEAAC,CAAA,IAAK,EAAE,IAAI;mEACf,MAAM,CAAC;wBAEV,IAAI,MAAM,MAAM,GAAG,GAAG,MAAM,IAAI,MAAM;wBAEtC,MAAM,SAAS,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG;qEAAC,CAAA,IAAK,EAAE,IAAI;;wBAClD,MAAM,MAAc,EAAE;wBAEtB,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;4BACrC,MAAM,QAAQ,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG;wEAAC,CAAA,IAAK,EAAE,IAAI;;4BACjD,IAAI,MAAM,MAAM,KAAK,OAAO,MAAM,EAAE;4BAEpC,MAAM,MAA8B,CAAC;4BACrC,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,EAAE;4BAEjE,MAAM,OAAQ,GAAG,CAAC,OAAO,IAAI;4BAC7B,IAAI,CAAC,UAAU,QAAQ,CAAC,OAAO;4BAE/B,MAAM,OAAO,OAAO,GAAG,CAAC,IAAI;4BAC5B,MAAM,IAAI,OAAO,GAAG,CAAC,IAAI;4BACzB,MAAM,OAAO,OAAO,GAAG,CAAC,IAAI;4BAC5B,MAAM,OAAO,OAAO,GAAG,CAAC,QAAQ;4BAChC,MAAM,OAAO,OAAO,GAAG,CAAC,QAAQ;4BAChC,MAAM,OAAO,OAAO,GAAG,CAAC,IAAI;4BAE5B,IAAI;gCAAC;gCAAM;gCAAG;gCAAM;gCAAM;gCAAM;6BAAK,CAAC,IAAI;kEAAC,CAAA,IAAK,CAAC,OAAO,QAAQ,CAAC;kEAAK;4BAEtE,IAAI,IAAI,CAAC;gCACP,IAAI,GAAG,CAAC,KAAK,IAAI,CAAC,KAAK,EAAE,GAAG;gCAC5B,MAAM,GAAG,CAAC,OAAO,IAAI,CAAC,KAAK,EAAE,GAAG;gCAChC;gCACA,MAAM,OAAO,2JAAK;gCAClB;gCACA,KAAK,+JAAe,CAAC,QAAQ,CAAC;gCAC9B,OAAO,+JAAe,CAAC,QAAQ,CAAC;gCAChC,OAAO,+JAAe,CAAC,QAAQ,CAAC;gCAChC,IAAI,+JAAe,CAAC,QAAQ,CAAC;gCAC7B,UAAU,gKAAU;4BACtB;wBACF;wBAEA,IAAI,CAAC,WAAW;4BACd,UAAU;4BACV,SAAS;wBACX;oBACF,EAAE,OAAO,KAAU;wBACjB,IAAI,CAAC,WAAW;4BACd,UAAU;4BACV,SAAS,IAAI,OAAO,IAAI,OAAO;wBACjC;oBACF;gBACF;aAAC;YAED;kDAAO;oBACL,YAAY;gBACd;;QACF;yCAAG;QAAC;QAAK,KAAK,SAAS,CAAC;KAAW;IAEnC,OAAO;QAAE;QAAQ;IAAM;AACzB;GA7EgB","debugId":null}},
    {"offset": {"line": 2445, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/utils/simClock.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  SECONDS_PER_DAY,\r\n  MILISECONDS_PER_DAY,\r\n  DAYS_PER_YEAR,\r\n} from \"@/components/gtoc/utils/constants\";\r\nimport { useEffect, useRef, useState, useCallback } from \"react\";\r\n\r\n/* ============================== Helpers ============================== */\r\n\r\n/** Clamps a number between optional bounds. */\r\nexport function clamp(v: number, lo?: number, hi?: number) {\r\n  if (lo != null && v < lo) return lo;\r\n  if (hi != null && v > hi) return hi;\r\n  return v;\r\n}\r\n\r\n/** Converts Date ‚Üí Julian Date. */\r\nexport function dateToJD(date: Date): number {\r\n  return date.getTime() / MILISECONDS_PER_DAY + 2440587.5;\r\n}\r\n\r\n/** Converts Julian Date ‚Üí Date. */\r\nexport function jdToDate(jd: number): Date {\r\n  return new Date((jd - 2440587.5) * MILISECONDS_PER_DAY);\r\n}\r\n\r\n/** Builds an array of JD milestones between start and end. */\r\nexport function buildMilestonesByStep(\r\n  jdStart: number,\r\n  jdEnd: number,\r\n  stepDays: number\r\n): number[] {\r\n  const out: number[] = [];\r\n  const dir = Math.sign(jdEnd - jdStart) || 1;\r\n  const step = Math.abs(stepDays) * dir;\r\n  let jd = jdStart;\r\n\r\n  if (dir > 0) {\r\n    while (jd <= jdEnd) {\r\n      out.push(jd);\r\n      jd += step;\r\n    }\r\n  } else {\r\n    while (jd >= jdEnd) {\r\n      out.push(jd);\r\n      jd += step;\r\n    }\r\n  }\r\n\r\n  if (out[out.length - 1] !== jdEnd) out.push(jdEnd);\r\n  return out;\r\n}\r\n\r\n/** Creates a JD range centered at `centerJD` with ¬±`years`. */\r\nexport function makeJDRangeFromYears(centerJD: number, years: number) {\r\n  const days = years * DAYS_PER_YEAR;\r\n  return { jdMin: centerJD - days, jdMax: centerJD + days };\r\n}\r\n\r\n/* ============================ useSimClock ============================ */\r\n\r\nexport type SimClockOpts = {\r\n  jd0?: number;\r\n  jdMin?: number;\r\n  jdMax?: number;\r\n  milestones?: number[];\r\n  snapPlayToMilestones?: boolean;\r\n  milestoneStepsPerSec?: number;\r\n  playing?: boolean;\r\n  /** Rate in days per second (default: 50). */\r\n  rate0?: number;\r\n};\r\n\r\n/**\r\n * Simulation clock that advances Julian Date continuously or by discrete milestones.\r\n * Internally runs a single requestAnimationFrame loop for stable timing.\r\n */\r\nexport function useSimClock(opts: SimClockOpts = {}) {\r\n  const {\r\n    jd0,\r\n    jdMin,\r\n    jdMax,\r\n    milestones,\r\n    snapPlayToMilestones = false,\r\n    milestoneStepsPerSec = 2,\r\n    playing = true,\r\n    rate0 = 50,\r\n  } = opts;\r\n\r\n  const [jd, _setJD] = useState<number>(() =>\r\n    clamp(jd0 ?? dateToJD(new Date()), jdMin, jdMax)\r\n  );\r\n  const [isPlaying, _setPlaying] = useState<boolean>(playing);\r\n  const [rate, _setRate] = useState<number>(rate0); // days per second\r\n\r\n  /* Refs to avoid stale closures */\r\n  const jdRef = useRef(jd);\r\n  const rateRef = useRef(rate);\r\n  const playingRef = useRef(isPlaying);\r\n  const minJDRef = useRef(jdMin);\r\n  const maxJDRef = useRef(jdMax);\r\n  const milestonesRef = useRef(milestones);\r\n  const snapRef = useRef(snapPlayToMilestones);\r\n  const stepPerSecRef = useRef(milestoneStepsPerSec);\r\n  const lastGoodRateRef = useRef(rate0 > 0 ? rate0 : 1);\r\n  const idxRef = useRef(0);\r\n  const rafRef = useRef<number | null>(null);\r\n  const lastTsRef = useRef<number | null>(null);\r\n\r\n  /* Sync state to refs */\r\n  useEffect(() => {\r\n    jdRef.current = jd;\r\n  }, [jd]);\r\n  useEffect(() => {\r\n    rateRef.current = rate;\r\n    if (Number.isFinite(rate) && rate > 0) lastGoodRateRef.current = rate;\r\n  }, [rate]);\r\n  useEffect(() => {\r\n    playingRef.current = isPlaying;\r\n  }, [isPlaying]);\r\n  useEffect(() => {\r\n    minJDRef.current = jdMin;\r\n  }, [jdMin]);\r\n  useEffect(() => {\r\n    maxJDRef.current = jdMax;\r\n  }, [jdMax]);\r\n  useEffect(() => {\r\n    milestonesRef.current = milestones;\r\n  }, [milestones]);\r\n  useEffect(() => {\r\n    snapRef.current = snapPlayToMilestones;\r\n  }, [snapPlayToMilestones]);\r\n  useEffect(() => {\r\n    stepPerSecRef.current = milestoneStepsPerSec;\r\n  }, [milestoneStepsPerSec]);\r\n\r\n  /* State setters */\r\n  const setJD = useCallback((v: number | ((prev: number) => number)) => {\r\n    _setJD(prev => {\r\n      const raw = typeof v === \"function\" ? (v as (p: number) => number)(prev) : v;\r\n      const lo = minJDRef.current ?? -Infinity;\r\n      const hi = maxJDRef.current ?? Infinity;\r\n      const next = clamp(raw, lo, hi);\r\n      jdRef.current = next;\r\n      return next;\r\n    });\r\n  }, []);\r\n\r\n  const setRate = useCallback((v: number) => {\r\n    _setRate(v);\r\n    rateRef.current = v;\r\n    if (Number.isFinite(v) && v > 0) lastGoodRateRef.current = v;\r\n  }, []);\r\n\r\n  const setPlaying = useCallback((v: boolean) => {\r\n    _setPlaying(v);\r\n    playingRef.current = v;\r\n    if (!v) lastTsRef.current = null;\r\n  }, []);\r\n\r\n  /* Keeps milestone index near current jd */\r\n  useEffect(() => {\r\n    const ms = milestonesRef.current;\r\n    if (!ms?.length) return;\r\n    let best = 0;\r\n    let bd = Infinity;\r\n    for (let k = 0; k < ms.length; k++) {\r\n      const d = Math.abs(ms[k] - jdRef.current);\r\n      if (d < bd) {\r\n        bd = d;\r\n        best = k;\r\n      }\r\n    }\r\n    idxRef.current = best;\r\n  }, [milestones, jd]);\r\n\r\n  /* Main RAF loop */\r\n  useEffect(() => {\r\n    function tick(ts: number) {\r\n      if (lastTsRef.current == null) lastTsRef.current = ts;\r\n      const prevTs = lastTsRef.current;\r\n      lastTsRef.current = ts;\r\n      const dtSec = Math.max(0, (ts - prevTs) / 1000);\r\n\r\n      if (playingRef.current) {\r\n        const lo = minJDRef.current ?? -Infinity;\r\n        const hi = maxJDRef.current ?? Infinity;\r\n\r\n        if (snapRef.current && milestonesRef.current?.length) {\r\n          const ms = milestonesRef.current;\r\n          const maxIdx = ms.length - 1;\r\n          let idx = idxRef.current + stepPerSecRef.current * dtSec;\r\n          idx = clamp(idx, 0, maxIdx);\r\n          idxRef.current = idx;\r\n\r\n          const jdSnap = ms[Math.round(idx)];\r\n          const next = clamp(jdSnap, lo, hi);\r\n          _setJD(next);\r\n          jdRef.current = next;\r\n\r\n          if (next <= lo || next >= hi || Math.round(idx) === 0 || Math.round(idx) === maxIdx) {\r\n            _setPlaying(false);\r\n            playingRef.current = false;\r\n          }\r\n        } else {\r\n          const r =\r\n            Number.isFinite(rateRef.current) && rateRef.current > 0\r\n              ? rateRef.current\r\n              : lastGoodRateRef.current;\r\n\r\n          if (r > 0) {\r\n            let next = jdRef.current + r * dtSec;\r\n            next = clamp(next, lo, hi);\r\n            _setJD(next);\r\n            jdRef.current = next;\r\n\r\n            if ((next === hi && r > 0) || (next === lo && r < 0)) {\r\n              _setPlaying(false);\r\n              playingRef.current = false;\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        lastTsRef.current = ts; // paused: avoids dt spike\r\n      }\r\n\r\n      rafRef.current = requestAnimationFrame(tick);\r\n    }\r\n\r\n    rafRef.current = requestAnimationFrame(tick);\r\n    return () => {\r\n      if (rafRef.current != null) cancelAnimationFrame(rafRef.current);\r\n      rafRef.current = null;\r\n      lastTsRef.current = null;\r\n    };\r\n  }, []);\r\n\r\n  return { jd, setJD, isPlaying, setPlaying, rate, setRate };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAEA;AAKA;;AAPA;;;AAYO,SAAS,MAAM,CAAS,EAAE,EAAW,EAAE,EAAW;IACvD,IAAI,MAAM,QAAQ,IAAI,IAAI,OAAO;IACjC,IAAI,MAAM,QAAQ,IAAI,IAAI,OAAO;IACjC,OAAO;AACT;AAGO,SAAS,SAAS,IAAU;IACjC,OAAO,KAAK,OAAO,KAAK,yKAAmB,GAAG;AAChD;AAGO,SAAS,SAAS,EAAU;IACjC,OAAO,IAAI,KAAK,CAAC,KAAK,SAAS,IAAI,yKAAmB;AACxD;AAGO,SAAS,sBACd,OAAe,EACf,KAAa,EACb,QAAgB;IAEhB,MAAM,MAAgB,EAAE;IACxB,MAAM,MAAM,KAAK,IAAI,CAAC,QAAQ,YAAY;IAC1C,MAAM,OAAO,KAAK,GAAG,CAAC,YAAY;IAClC,IAAI,KAAK;IAET,IAAI,MAAM,GAAG;QACX,MAAO,MAAM,MAAO;YAClB,IAAI,IAAI,CAAC;YACT,MAAM;QACR;IACF,OAAO;QACL,MAAO,MAAM,MAAO;YAClB,IAAI,IAAI,CAAC;YACT,MAAM;QACR;IACF;IAEA,IAAI,GAAG,CAAC,IAAI,MAAM,GAAG,EAAE,KAAK,OAAO,IAAI,IAAI,CAAC;IAC5C,OAAO;AACT;AAGO,SAAS,qBAAqB,QAAgB,EAAE,KAAa;IAClE,MAAM,OAAO,QAAQ,mKAAa;IAClC,OAAO;QAAE,OAAO,WAAW;QAAM,OAAO,WAAW;IAAK;AAC1D;AAoBO,SAAS,YAAY,OAAqB,CAAC,CAAC;;IACjD,MAAM,EACJ,GAAG,EACH,KAAK,EACL,KAAK,EACL,UAAU,EACV,uBAAuB,KAAK,EAC5B,uBAAuB,CAAC,EACxB,UAAU,IAAI,EACd,QAAQ,EAAE,EACX,GAAG;IAEJ,MAAM,CAAC,IAAI,OAAO,GAAG,IAAA,yKAAQ;gCAAS,IACpC,MAAM,OAAO,SAAS,IAAI,SAAS,OAAO;;IAE5C,MAAM,CAAC,WAAW,YAAY,GAAG,IAAA,yKAAQ,EAAU;IACnD,MAAM,CAAC,MAAM,SAAS,GAAG,IAAA,yKAAQ,EAAS,QAAQ,kBAAkB;IAEpE,gCAAgC,GAChC,MAAM,QAAQ,IAAA,uKAAM,EAAC;IACrB,MAAM,UAAU,IAAA,uKAAM,EAAC;IACvB,MAAM,aAAa,IAAA,uKAAM,EAAC;IAC1B,MAAM,WAAW,IAAA,uKAAM,EAAC;IACxB,MAAM,WAAW,IAAA,uKAAM,EAAC;IACxB,MAAM,gBAAgB,IAAA,uKAAM,EAAC;IAC7B,MAAM,UAAU,IAAA,uKAAM,EAAC;IACvB,MAAM,gBAAgB,IAAA,uKAAM,EAAC;IAC7B,MAAM,kBAAkB,IAAA,uKAAM,EAAC,QAAQ,IAAI,QAAQ;IACnD,MAAM,SAAS,IAAA,uKAAM,EAAC;IACtB,MAAM,SAAS,IAAA,uKAAM,EAAgB;IACrC,MAAM,YAAY,IAAA,uKAAM,EAAgB;IAExC,sBAAsB,GACtB,IAAA,0KAAS;iCAAC;YACR,MAAM,OAAO,GAAG;QAClB;gCAAG;QAAC;KAAG;IACP,IAAA,0KAAS;iCAAC;YACR,QAAQ,OAAO,GAAG;YAClB,IAAI,OAAO,QAAQ,CAAC,SAAS,OAAO,GAAG,gBAAgB,OAAO,GAAG;QACnE;gCAAG;QAAC;KAAK;IACT,IAAA,0KAAS;iCAAC;YACR,WAAW,OAAO,GAAG;QACvB;gCAAG;QAAC;KAAU;IACd,IAAA,0KAAS;iCAAC;YACR,SAAS,OAAO,GAAG;QACrB;gCAAG;QAAC;KAAM;IACV,IAAA,0KAAS;iCAAC;YACR,SAAS,OAAO,GAAG;QACrB;gCAAG;QAAC;KAAM;IACV,IAAA,0KAAS;iCAAC;YACR,cAAc,OAAO,GAAG;QAC1B;gCAAG;QAAC;KAAW;IACf,IAAA,0KAAS;iCAAC;YACR,QAAQ,OAAO,GAAG;QACpB;gCAAG;QAAC;KAAqB;IACzB,IAAA,0KAAS;iCAAC;YACR,cAAc,OAAO,GAAG;QAC1B;gCAAG;QAAC;KAAqB;IAEzB,iBAAiB,GACjB,MAAM,QAAQ,IAAA,4KAAW;0CAAC,CAAC;YACzB;kDAAO,CAAA;oBACL,MAAM,MAAM,OAAO,MAAM,aAAa,AAAC,EAA4B,QAAQ;oBAC3E,MAAM,KAAK,SAAS,OAAO,IAAI,CAAC;oBAChC,MAAM,KAAK,SAAS,OAAO,IAAI;oBAC/B,MAAM,OAAO,MAAM,KAAK,IAAI;oBAC5B,MAAM,OAAO,GAAG;oBAChB,OAAO;gBACT;;QACF;yCAAG,EAAE;IAEL,MAAM,UAAU,IAAA,4KAAW;4CAAC,CAAC;YAC3B,SAAS;YACT,QAAQ,OAAO,GAAG;YAClB,IAAI,OAAO,QAAQ,CAAC,MAAM,IAAI,GAAG,gBAAgB,OAAO,GAAG;QAC7D;2CAAG,EAAE;IAEL,MAAM,aAAa,IAAA,4KAAW;+CAAC,CAAC;YAC9B,YAAY;YACZ,WAAW,OAAO,GAAG;YACrB,IAAI,CAAC,GAAG,UAAU,OAAO,GAAG;QAC9B;8CAAG,EAAE;IAEL,yCAAyC,GACzC,IAAA,0KAAS;iCAAC;YACR,MAAM,KAAK,cAAc,OAAO;YAChC,IAAI,CAAC,IAAI,QAAQ;YACjB,IAAI,OAAO;YACX,IAAI,KAAK;YACT,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,MAAM,EAAE,IAAK;gBAClC,MAAM,IAAI,KAAK,GAAG,CAAC,EAAE,CAAC,EAAE,GAAG,MAAM,OAAO;gBACxC,IAAI,IAAI,IAAI;oBACV,KAAK;oBACL,OAAO;gBACT;YACF;YACA,OAAO,OAAO,GAAG;QACnB;gCAAG;QAAC;QAAY;KAAG;IAEnB,iBAAiB,GACjB,IAAA,0KAAS;iCAAC;YACR,SAAS,KAAK,EAAU;gBACtB,IAAI,UAAU,OAAO,IAAI,MAAM,UAAU,OAAO,GAAG;gBACnD,MAAM,SAAS,UAAU,OAAO;gBAChC,UAAU,OAAO,GAAG;gBACpB,MAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,CAAC,KAAK,MAAM,IAAI;gBAE1C,IAAI,WAAW,OAAO,EAAE;oBACtB,MAAM,KAAK,SAAS,OAAO,IAAI,CAAC;oBAChC,MAAM,KAAK,SAAS,OAAO,IAAI;oBAE/B,IAAI,QAAQ,OAAO,IAAI,cAAc,OAAO,EAAE,QAAQ;wBACpD,MAAM,KAAK,cAAc,OAAO;wBAChC,MAAM,SAAS,GAAG,MAAM,GAAG;wBAC3B,IAAI,MAAM,OAAO,OAAO,GAAG,cAAc,OAAO,GAAG;wBACnD,MAAM,MAAM,KAAK,GAAG;wBACpB,OAAO,OAAO,GAAG;wBAEjB,MAAM,SAAS,EAAE,CAAC,KAAK,KAAK,CAAC,KAAK;wBAClC,MAAM,OAAO,MAAM,QAAQ,IAAI;wBAC/B,OAAO;wBACP,MAAM,OAAO,GAAG;wBAEhB,IAAI,QAAQ,MAAM,QAAQ,MAAM,KAAK,KAAK,CAAC,SAAS,KAAK,KAAK,KAAK,CAAC,SAAS,QAAQ;4BACnF,YAAY;4BACZ,WAAW,OAAO,GAAG;wBACvB;oBACF,OAAO;wBACL,MAAM,IACJ,OAAO,QAAQ,CAAC,QAAQ,OAAO,KAAK,QAAQ,OAAO,GAAG,IAClD,QAAQ,OAAO,GACf,gBAAgB,OAAO;wBAE7B,IAAI,IAAI,GAAG;4BACT,IAAI,OAAO,MAAM,OAAO,GAAG,IAAI;4BAC/B,OAAO,MAAM,MAAM,IAAI;4BACvB,OAAO;4BACP,MAAM,OAAO,GAAG;4BAEhB,IAAI,AAAC,SAAS,MAAM,IAAI,KAAO,SAAS,MAAM,IAAI,GAAI;gCACpD,YAAY;gCACZ,WAAW,OAAO,GAAG;4BACvB;wBACF;oBACF;gBACF,OAAO;oBACL,UAAU,OAAO,GAAG,IAAI,0BAA0B;gBACpD;gBAEA,OAAO,OAAO,GAAG,sBAAsB;YACzC;YAEA,OAAO,OAAO,GAAG,sBAAsB;YACvC;yCAAO;oBACL,IAAI,OAAO,OAAO,IAAI,MAAM,qBAAqB,OAAO,OAAO;oBAC/D,OAAO,OAAO,GAAG;oBACjB,UAAU,OAAO,GAAG;gBACtB;;QACF;gCAAG,EAAE;IAEL,OAAO;QAAE;QAAI;QAAO;QAAW;QAAY;QAAM;IAAQ;AAC3D;GAjKgB","debugId":null}},
    {"offset": {"line": 2695, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luism/OneDrive/Documents/Research/GTOC_visualizer/GTOC%20Visualizer/src/components/gtoc/viewerCanvas.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState, useMemo } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { Canvas } from \"@react-three/fiber\";\r\nimport { OrbitControls, Stars } from \"@react-three/drei\";\r\nimport * as THREE from \"three\";\r\n\r\nimport { SolutionsUI, Solutions3D } from \"@/components/gtoc/solutions\";\r\nimport HUD from \"@/components/gtoc/sceneParts/HUD\";\r\nimport BodyPoint from \"@/components/gtoc/sceneParts/BodyPoint\";\r\nimport { OrbitPath, Sun, Axes, CameraRig } from \"@/components/gtoc/KeplerSolver\";\r\nimport {\r\n  TYPE_COLORS,\r\n  JD_EPOCH_0,\r\n  DAYS_PER_YEAR,\r\n} from \"@/components/gtoc/utils/constants\";\r\nimport { useBodiesFromGTOCCSV } from \"@/components/gtoc/utils/dataLoader\";\r\nimport { useSimClock } from \"@/components/gtoc/utils/simClock\";\r\nimport type { HoverPayload } from \"@/components/gtoc/solutions/SolutionPath\";\r\n\r\n/* ---------- Types ---------- */\r\nexport type ViewerCanvasProps = Partial<{\r\n  bodies: any[];\r\n  jd: number;\r\n  setJD: React.Dispatch<React.SetStateAction<number>>;\r\n  isPlaying: boolean;\r\n  setPlaying: React.Dispatch<React.SetStateAction<boolean>>;\r\n  rate: number;\r\n  setRate: React.Dispatch<React.SetStateAction<number>>;\r\n  milestonesJD: number[];\r\n  milestonesISO: string[];\r\n}>;\r\n\r\ntype HoverState = { data: HoverPayload; x: number; y: number } | null;\r\n\r\n/* ======================= Main Component ======================= */\r\nexport default function ViewerCanvas(props: ViewerCanvasProps = {}) {\r\n  /* ---- Simulation clock ---- */\r\n  const usingExternalClock =\r\n    props.jd !== undefined &&\r\n    props.setJD &&\r\n    props.isPlaying !== undefined &&\r\n    props.setPlaying &&\r\n    props.rate !== undefined &&\r\n    props.setRate;\r\n\r\n  const { jd, setJD, isPlaying, setPlaying, rate, setRate } = usingExternalClock\r\n    ? (props as Required<\r\n        Pick<\r\n          ViewerCanvasProps,\r\n          \"jd\" | \"setJD\" | \"isPlaying\" | \"setPlaying\" | \"rate\" | \"setRate\"\r\n        >\r\n      >)\r\n    : useSimClock();\r\n\r\n  /* ---- Load celestial bodies ---- */\r\n  const bodiesHook = useBodiesFromGTOCCSV(\"/data/df_extracted_full.csv\", [\r\n    \"Planet\",\r\n    \"Asteroid\",\r\n    \"Comet\",\r\n  ]);\r\n  const bodies = props.bodies ?? bodiesHook.bodies ?? [];\r\n  const hookError = bodiesHook.error;\r\n\r\n  /* ---- Tooltip state ---- */\r\n  const [hover, setHover] = useState<HoverState>(null);\r\n\r\n  const bodyName = useMemo(() => {\r\n    const m = new Map<number, string>();\r\n    bodies?.forEach((b: any) => {\r\n      const idNum = Number(b.id);\r\n      const nm = (b.name && String(b.name).trim()) || `#${idNum || \"?\"}`;\r\n      if (!Number.isNaN(idNum)) m.set(idNum, nm);\r\n    });\r\n    return m;\r\n  }, [bodies]);\r\n\r\n  /* ---- Tooltip overlay ---- */\r\n  const tooltip = hover && (\r\n    <div\r\n      className=\"pointer-events-none fixed z-[2147483646] select-none\"\r\n      style={{ left: hover.x + 14, top: hover.y + 16 }}\r\n    >\r\n      <div\r\n        className=\"rounded-xl p-[1px]\"\r\n        style={{\r\n          background: `linear-gradient(135deg, ${hover.data.color}99 0%, rgba(255,255,255,0.2) 70%)`,\r\n          boxShadow: \"0 6px 20px rgba(0,0,0,0.35)\",\r\n        }}\r\n      >\r\n        <div className=\"rounded-xl backdrop-blur-md bg-black/85 px-3 py-2 text-[11px] text-white min-w-[200px] border border-white/10 shadow-2xl\">\r\n          {/* === Header: color dot + solution name === */}\r\n          <div className=\"flex items-center justify-center mb-2\">\r\n            <span\r\n              className=\"inline-block h-2.5 w-2.5 rounded-full ring-2 ring-white/30 mr-2\"\r\n              style={{ backgroundColor: hover.data.color }}\r\n            />\r\n            <div className=\"font-semibold text-white/90 truncate\">\r\n              {hover.data.solutionName}\r\n            </div>\r\n          </div>\r\n\r\n          {/* === Body: leg path === */}\r\n          <div className=\"text-xs text-center text-white/70 mb-1\">\r\n            {hover.data.fromBody\r\n              ? bodyName.get(hover.data.fromBody) ?? `#${hover.data.fromBody}`\r\n              : \"‚Äî\"}{\" \"}\r\n            <span className=\"opacity-50\">‚Üí</span>{\" \"}\r\n            {hover.data.toBody\r\n              ? bodyName.get(hover.data.toBody) ?? `#${hover.data.toBody}`\r\n              : \"‚Äî\"}\r\n          </div>\r\n\r\n          {/* === Footer: leg index + TOF === */}\r\n          <div className=\"mt-1 pt-1 border-t border-white/10 text-[10px] text-white/60 text-center\">\r\n            Leg {hover.data.legIndex} ‚Ä¢ TOF {hover.data.tofDays.toFixed(1)} days\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n\r\n  /* ---- Render ---- */\r\n  return (\r\n    <div className=\"relative w-full h-screen bg-black\">\r\n      {/* üß≠ Overlay UI */}\r\n      <SolutionsUI />\r\n\r\n      {/* ü™ê 3D Scene */}\r\n      <Canvas\r\n        dpr={[1, 2]}\r\n        camera={{ fov: 65, near: 0.001, far: 1e12, position: [0, 0, 2e6] }}\r\n      >\r\n        {/* Scene setup */}\r\n        <color attach=\"background\" args={[\"#000000\"]} />\r\n        <ambientLight intensity={0.6} />\r\n        <pointLight position={[0, 0, 0]} intensity={2.0} color=\"#ffffff\" />\r\n\r\n        <CameraRig />\r\n        <OrbitControls enableDamping dampingFactor={0.1} />\r\n        <Stars radius={100} depth={50} count={1000} factor={2} fade speed={0.5} />\r\n\r\n        <Sun />\r\n        <Axes size={1.0} />\r\n\r\n        {/* === Celestial Bodies === */}\r\n        {bodies?.map((b: any) => (\r\n          <group key={b.id}>\r\n            {b.type === \"Planet\" && b.e < 1 ? (\r\n              <>\r\n                <OrbitPath\r\n                  body={b}\r\n                  visible\r\n                  segments={256}\r\n                  color={b.color ?? TYPE_COLORS[b.type as \"Planet\" | \"Asteroid\" | \"Comet\"]}\r\n                />\r\n                <BodyPoint body={b} jd={jd} showLabel />\r\n              </>\r\n            ) : (\r\n              <BodyPoint body={b} jd={jd} />\r\n            )}\r\n          </group>\r\n        ))}\r\n\r\n        {/* ‚úÖ Imported Trajectories with hover */}\r\n        <Solutions3D\r\n          currentJD={jd}\r\n          epochZeroJD={JD_EPOCH_0}\r\n          showShip\r\n          onHover={(data, x, y) => setHover({ data, x, y })}\r\n          onUnhover={() => setHover(null)}\r\n        />\r\n      </Canvas>\r\n\r\n      {/* ‚ú® Tooltip */}\r\n      {tooltip}\r\n\r\n      {/* === HUD overlay === */}\r\n      <PortalHUD>\r\n        <div className=\"pointer-events-auto fixed left-1/2 -translate-x-1/2 bottom-2 z-[999] w-full max-w-[120rem] px-3\">\r\n          <HUD\r\n            jd={jd}\r\n            setJD={setJD}\r\n            isPlaying={isPlaying}\r\n            setPlaying={setPlaying}\r\n            rate={rate}\r\n            setRate={setRate}\r\n            candidates={[]}\r\n            jdMin={JD_EPOCH_0}\r\n            jdMax={JD_EPOCH_0 + 200 * DAYS_PER_YEAR}\r\n            milestonesJD={\r\n              props.milestonesJD ?? [\r\n                JD_EPOCH_0,\r\n                JD_EPOCH_0 + 50 * DAYS_PER_YEAR,\r\n                JD_EPOCH_0 + 100 * DAYS_PER_YEAR,\r\n              ]\r\n            }\r\n            milestonesISO={\r\n              props.milestonesISO ?? [\r\n                \"2000-01-01\",\r\n                \"2050-01-01\",\r\n                \"2100-01-01\",\r\n              ]\r\n            }\r\n          />\r\n        </div>\r\n      </PortalHUD>\r\n\r\n      {/* === Error banner === */}\r\n      {hookError && (\r\n        <div className=\"absolute top-16 right-3 z-[80] text-xs pointer-events-none\">\r\n          <div className=\"px-3 py-2 rounded bg-red-600 text-white shadow\">\r\n            {hookError}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ======================= Utility Components ======================= */\r\nfunction PortalHUD({ children }: { children: React.ReactNode }) {\r\n  const [mounted, setMounted] = useState(false);\r\n  useEffect(() => setMounted(true), []);\r\n  if (!mounted) return null;\r\n  return createPortal(children, document.body);\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}